# 工作流（从模板开始）

工作流目前资料相对有限，最稳妥的方式是：**先用模板跑通，再按需求逐步修改**。  
不建议一开始从空白画布搭建完整流程。

---

## 建议使用方式

按下面顺序操作，通常最省时间：

1. 先选一个最接近需求的模板。
2. 先只改最小输入（例如触发内容、目标地址）。
3. 运行一次，确认主链可以走完。
4. 每次只改一个节点或一条连线，改完立即再运行。
5. 对关键动作保留失败分支（`on_error`）。

如果一次改动过多，后续排错会明显变慢。

---

## 必要概念（够用版）

### 连接

连接用于控制流程走向：

- 成功后走哪条线（`on_success`）
- 失败后走哪条线（`on_error`）
- 条件为真/假走哪条线（`true` / `false`）

### 引用

引用用于传递数据：

- 下游节点参数不写死
- 直接使用上游节点输出

### 关系

- 连接决定执行路径
- 引用决定参数来源

---

## 案例：社区自动发帖与巡检

这是一个“周期执行 + 状态跟踪”场景：

- 目标：定期让 AI 执行动作并持续巡检结果
- 约束：平台有频率限制（例如每 30 分钟一次）
- 做法：使用工作流调度，减少手动重复操作

### 案例截图

![workflow-case-01|225x500, 50%](/manuals/assets/workflow/01.png)

![workflow-case-02|225x500, 50%](/manuals/assets/workflow/02.png)
![workflow-case-03|225x500, 50%](/manuals/assets/workflow/03.png)

![workflow-case-04|225x500,50%](/manuals/assets/workflow/04.png)
![workflow-case-05|225x500, 50%](/manuals/assets/workflow/05.png)

![workflow-case-06|225x500, 50%](/manuals/assets/workflow/06.png)
![workflow-case-07|225x500, 50%](/manuals/assets/workflow/07.png)

![workflow-case-08|225x500, 50%](/manuals/assets/workflow/08.png)
![workflow-case-09|225x500, 50%](/manuals/assets/workflow/09.png)

### 实操注意

- 自动生成后节点可能重叠，先整理布局再调试。
- 偶发列表不刷新时，重新进入应用通常可恢复。
- 在 `工作流 > 编辑工作流` 可启用或停用流程。
- 已有节点可长按进入编辑。

---

## 内置模板选型（8 个）

### 1）Intent 触发对话并回传结果

- 适用：由外部系统触发，AI 处理后回传结果。
- 主链：接收触发 → 启动服务 → 新建会话 → 提取消息 → 发送给 AI → 停止服务 → 回传结果。

### 2）手动对话链路

- 适用：快速验证对话自动化主链。
- 主链：手动触发 → 启动服务 → 新建会话 → 发送消息 → 停止服务。

### 3）条件分支网页流程

- 适用：网页巡检后按条件分流。
- 主链：访问网页 → 提取信息 → 条件判断 → 真分支/假分支。

### 4）逻辑 AND 分支流程

- 适用：必须同时满足多个条件才继续。

### 5）逻辑 OR 分支流程

- 适用：任一条件满足即可继续。

### 6）提取/运算演示流程

- 适用：练习提取、加工、判断、输出的基本流水线。

### 7）成功/失败分支骨架

- 适用：给关键动作增加标准异常兜底。

### 8）语音触发启动对话

- 适用：通过语音关键词唤起执行。

---

## 排错顺序（建议固定）

1. 先看上游节点输出是否符合预期。
2. 再看连接条件是否写对。
3. 再看引用是否指向正确节点。
4. 最后确认流程是否进入了预期分支。

---

## 与 AI 协作改模板（推荐写法）

```txt
请基于“条件分支网页流程”模板修改：
- 保持触发器和主链顺序不变
- 只替换条件判断内容和失败分支目标
- 每次只改一个节点，改完先给我预览
- 最后用箭头复述最终连接顺序
```

这类指令可以降低误改范围，便于回退和排查。

---

## 结论

工作流建议采用“模板优先”的方式使用。先跑通，再小步修改，通常比先追求完整理解更高效。