### 数据备份与恢复

在 Operit AI 中，进入 `设置` -> `数据备份与恢复`，可以看到不同类型的备份与恢复入口。

当前备份文件默认会写入：`Download/Operit/backup/`（按类型分子目录）。

#### 备份类型对比（先看这个表）

| 备份类型 | 主要内容 | 常见文件/目录 | 恢复影响 | 跨设备迁移 | 需要重启 |
| --- | --- | --- | --- | --- | --- |
| 聊天记录 | 会话消息与聊天内容 | `backup/chat`；导出支持 `JSON` / `Markdown` / `HTML` / `TXT` | 主要影响聊天数据，不会整体覆盖数据库 | 强（最推荐做迁移） | 否 |
| 角色卡 | 角色卡与角色相关数据 | `backup/character_cards` | 主要影响角色数据 | 强 | 否 |
| 记忆库 | 记忆条目与记忆内容 | `backup/memory` | 导入时可选“跳过 / 更新 / 新建”策略 | 中-强 | 否 |
| 模型配置 | 模型提供商、参数、接口配置（可能含密钥） | `backup/model_config` | 覆盖或更新模型配置 | 中（受网络与版本配置影响） | 通常否 |
| 数据库备份（Room） | 应用核心数据（聊天记录、角色卡、记忆、模型配置等） | `backup/room_db`；自动：`room_db_backup_YYYY-MM-DD.zip`；手动：`room_db_manual_backup_yyyy-MM-dd_HH-mm-ss.zip` | **会覆盖当前核心数据状态**，恢复前建议先做一次临时备份 | 弱（更适合同机回滚） | 是（建议立即重启） |
| 文件快照备份（实验） | 应用内部运行状态（内部文件、设置、数据库等；默认不含部分超大终端数据） | `backup/raw_snapshot` | **复原能力最强**；特别适合清数据/卸载前后做整体恢复，但会覆盖更多当前内容 | 弱（建议同版本同环境） | 是（建议立即重启） |

#### 聊天备份格式怎么选

导出时可选：

- `JSON`：结构化、便于再次导入 Operit，迁移首选。
- `Markdown`：会按会话导出为 Markdown 文件集合（压缩包），便于阅读与归档。
- `HTML`：适合浏览器查看。
- `TXT`：纯文本备份，兼容性高但结构最少。

导入时可选：

- `OPERIT`
- `CHATGPT`
- `CHATBOX`
- `MARKDOWN`
- `GENERIC_JSON`

如果你的目标是“跨设备继续聊天”，优先选择 `JSON` 导出 + 对应格式导入。

#### 记忆库导入策略区别

导入记忆时，界面里有三种策略：

| 策略 | 行为 | 适合场景 |
| --- | --- | --- |
| 跳过（推荐） | 遇到已存在项目时跳过，尽量不改当前数据 | 以“补充”为主，避免误覆盖 |
| 更新 | 用导入内容更新已存在项目 | 明确要同步到新版本记忆 |
| 新建 | 不覆盖原项，新增一份 | 想保留新旧两份进行对照 |

#### Room 数据库备份 vs 文件快照备份

- Room 数据库备份：聚焦应用核心业务数据（聊天记录、角色卡、记忆、模型配置等），体积通常更可控，适合日常回滚。
- 文件快照备份（实验）：覆盖应用多个内部目录，更接近“状态镜像”，很适合在“清数据前 / 卸载前”做一次完整留档，并不是“高级用户专属”。
- 覆盖范围越大，通常复原能力越强；例如重装后要尽量恢复原状态时，文件快照通常是优先选项。
- 同时，覆盖面大也意味着误恢复时回滚内容更多，所以操作风险也更高。

#### 实用建议（按目的选）

- 换手机 / 迁移聊天：优先“聊天记录备份”。
- 分享或迁移角色设定：用“角色卡备份”。
- 同步长期记忆：用“记忆库备份”，并先确认导入策略。
- 迁移模型接入配置：用“模型配置备份”，注意密钥安全。
- 防止误操作、想快速回滚：开启 Room 自动备份并保留手动备份点。
- 清数据前 / 卸载前：普通用户也建议优先做“文件快照备份（实验）”，重装后可用于最大程度恢复应用状态。

#### 安全提醒

- 模型配置备份可能包含敏感信息（如 API Key），请勿在不可信渠道传播。
- 执行 Room / 文件快照恢复前，建议先再做一次当前状态备份。
- 恢复后若界面提示重启，请按提示重启应用，确保状态一致。

