import{ak as ua,r,H as aa,_ as _t,ar as Ce,q as Ie,x as Fe,as as ue,z as Oe,aJ as va,A as ha,aK as jt,av as Qe,N as fa,aw as ga,at as ma,y as Wt,al as pa,Q as ya,G as yt,k as ba,m as xa,l as Ca,n as De,V as Gt,f as Ye,o as ja,ab as Sa,I as ra,t as ka,u as Ea,j as a,b as wa,e as Me,h as W,T as $a,B as xe,d as gt,C as Be,aL as Ma,an as Et}from"./index-BUC7ar-9.js";import{c as Vt,l as wt,a as $t,i as Mt,b as Xt,d as Oa,j as Ot,k as Ra,h as _a,m as Ta,L as ve,n as Kt,T as Da,f as La,o as Yt,p as Pa,q as Ha}from"./operitLocalStore-BUG9u9NC.js";import{A as mt}from"./index-AJnqX13Z.js";import{S as xt}from"./index-BN_AVXRX.js";import{I as Ct}from"./index-BG7-Innl.js";import{s as pt}from"./index-Bwaw2ub6.js";import{T as lt}from"./index-BWcCT85H.js";import"./EyeOutlined-DeyaywGd.js";function Ba(){return ua()}const Ia={useBreakpoint:Ba};function Tt(t,e,o){return(t-e)/(o-e)}function Pt(t,e,o,s){var c=Tt(e,o,s),v={};switch(t){case"rtl":v.right="".concat(c*100,"%"),v.transform="translateX(50%)";break;case"btt":v.bottom="".concat(c*100,"%"),v.transform="translateY(50%)";break;case"ttb":v.top="".concat(c*100,"%"),v.transform="translateY(-50%)";break;default:v.left="".concat(c*100,"%"),v.transform="translateX(-50%)";break}return v}function st(t,e){return Array.isArray(t)?t[e]:t}var it=r.createContext({min:0,max:0,direction:"ltr",step:1,includedStart:0,includedEnd:0,tabIndex:0,keyboard:!0,styles:{},classNames:{}}),Aa=r.createContext({}),Na=["prefixCls","value","valueIndex","onStartMove","onDelete","style","render","dragging","draggingDelete","onOffsetChange","onChangeComplete","onFocus","onMouseEnter"],Jt=r.forwardRef(function(t,e){var o=t.prefixCls,s=t.value,c=t.valueIndex,v=t.onStartMove,m=t.onDelete,u=t.style,y=t.render,f=t.dragging,g=t.draggingDelete,j=t.onOffsetChange,S=t.onChangeComplete,b=t.onFocus,p=t.onMouseEnter,d=aa(t,Na),l=r.useContext(it),h=l.min,i=l.max,C=l.direction,R=l.disabled,_=l.keyboard,N=l.range,G=l.tabIndex,Z=l.ariaLabelForHandle,T=l.ariaLabelledByForHandle,M=l.ariaRequired,k=l.ariaValueTextFormatterForHandle,$=l.styles,Y=l.classNames,ee="".concat(o,"-handle"),V=function(D){R||v(D,c)},X=function(D){b?.(D,c)},K=function(D){p(D,c)},Le=function(D){if(!R&&_){var O=null;switch(D.which||D.keyCode){case ue.LEFT:O=C==="ltr"||C==="btt"?-1:1;break;case ue.RIGHT:O=C==="ltr"||C==="btt"?1:-1;break;case ue.UP:O=C!=="ttb"?1:-1;break;case ue.DOWN:O=C!=="ttb"?-1:1;break;case ue.HOME:O="min";break;case ue.END:O="max";break;case ue.PAGE_UP:O=2;break;case ue.PAGE_DOWN:O=-2;break;case ue.BACKSPACE:case ue.DELETE:m?.(c);break}O!==null&&(D.preventDefault(),j(O,c))}},ne=function(D){switch(D.which||D.keyCode){case ue.LEFT:case ue.RIGHT:case ue.UP:case ue.DOWN:case ue.HOME:case ue.END:case ue.PAGE_UP:case ue.PAGE_DOWN:S?.();break}},ke=Pt(C,s,h,i),je={};if(c!==null){var pe;je={tabIndex:R?null:st(G,c),role:"slider","aria-valuemin":h,"aria-valuemax":i,"aria-valuenow":s,"aria-disabled":R,"aria-label":st(Z,c),"aria-labelledby":st(T,c),"aria-required":st(M,c),"aria-valuetext":(pe=st(k,c))===null||pe===void 0?void 0:pe(s),"aria-orientation":C==="ltr"||C==="rtl"?"horizontal":"vertical",onMouseDown:V,onTouchStart:V,onFocus:X,onMouseEnter:K,onKeyDown:Le,onKeyUp:ne}}var Ee=r.createElement("div",_t({ref:e,className:Ie(ee,Fe(Fe(Fe({},"".concat(ee,"-").concat(c+1),c!==null&&N),"".concat(ee,"-dragging"),f),"".concat(ee,"-dragging-delete"),g),Y.handle),style:Ce(Ce(Ce({},ke),u),$.handle)},je,d));return y&&(Ee=y(Ee,{index:c,prefixCls:o,value:s,dragging:f,draggingDelete:g})),Ee}),za=["prefixCls","style","onStartMove","onOffsetChange","values","handleRender","activeHandleRender","draggingIndex","draggingDelete","onFocus"],Fa=r.forwardRef(function(t,e){var o=t.prefixCls,s=t.style,c=t.onStartMove,v=t.onOffsetChange,m=t.values,u=t.handleRender,y=t.activeHandleRender,f=t.draggingIndex,g=t.draggingDelete,j=t.onFocus,S=aa(t,za),b=r.useRef({}),p=r.useState(!1),d=Oe(p,2),l=d[0],h=d[1],i=r.useState(-1),C=Oe(i,2),R=C[0],_=C[1],N=function(k){_(k),h(!0)},G=function(k,$){N($),j?.(k)},Z=function(k,$){N($)};r.useImperativeHandle(e,function(){return{focus:function(k){var $;($=b.current[k])===null||$===void 0||$.focus()},hideHelp:function(){va.flushSync(function(){h(!1)})}}});var T=Ce({prefixCls:o,onStartMove:c,onOffsetChange:v,render:u,onFocus:G,onMouseEnter:Z},S);return r.createElement(r.Fragment,null,m.map(function(M,k){var $=f===k;return r.createElement(Jt,_t({ref:function(ee){ee?b.current[k]=ee:delete b.current[k]},dragging:$,draggingDelete:$&&g,style:st(s,k),key:k,value:M,valueIndex:k},T))}),y&&l&&r.createElement(Jt,_t({key:"a11y"},T,{value:m[R],valueIndex:null,dragging:f!==-1,draggingDelete:g,render:y,style:{pointerEvents:"none"},tabIndex:null,"aria-hidden":!0})))}),Ua=function(e){var o=e.prefixCls,s=e.style,c=e.children,v=e.value,m=e.onClick,u=r.useContext(it),y=u.min,f=u.max,g=u.direction,j=u.includedStart,S=u.includedEnd,b=u.included,p="".concat(o,"-text"),d=Pt(g,v,y,f);return r.createElement("span",{className:Ie(p,Fe({},"".concat(p,"-active"),b&&j<=v&&v<=S)),style:Ce(Ce({},d),s),onMouseDown:function(h){h.stopPropagation()},onClick:function(){m(v)}},c)},qa=function(e){var o=e.prefixCls,s=e.marks,c=e.onClick,v="".concat(o,"-mark");return s.length?r.createElement("div",{className:v},s.map(function(m){var u=m.value,y=m.style,f=m.label;return r.createElement(Ua,{key:u,prefixCls:v,style:y,value:u,onClick:c},f)})):null},Wa=function(e){var o=e.prefixCls,s=e.value,c=e.style,v=e.activeStyle,m=r.useContext(it),u=m.min,y=m.max,f=m.direction,g=m.included,j=m.includedStart,S=m.includedEnd,b="".concat(o,"-dot"),p=g&&j<=s&&s<=S,d=Ce(Ce({},Pt(f,s,u,y)),typeof c=="function"?c(s):c);return p&&(d=Ce(Ce({},d),typeof v=="function"?v(s):v)),r.createElement("span",{className:Ie(b,Fe({},"".concat(b,"-active"),p)),style:d})},Ga=function(e){var o=e.prefixCls,s=e.marks,c=e.dots,v=e.style,m=e.activeStyle,u=r.useContext(it),y=u.min,f=u.max,g=u.step,j=r.useMemo(function(){var S=new Set;if(s.forEach(function(p){S.add(p.value)}),c&&g!==null)for(var b=y;b<=f;)S.add(b),b+=g;return Array.from(S)},[y,f,g,c,s]);return r.createElement("div",{className:"".concat(o,"-step")},j.map(function(S){return r.createElement(Wa,{prefixCls:o,key:S,value:S,style:v,activeStyle:m})}))},Qt=function(e){var o=e.prefixCls,s=e.style,c=e.start,v=e.end,m=e.index,u=e.onStartMove,y=e.replaceCls,f=r.useContext(it),g=f.direction,j=f.min,S=f.max,b=f.disabled,p=f.range,d=f.classNames,l="".concat(o,"-track"),h=Tt(c,j,S),i=Tt(v,j,S),C=function(G){!b&&u&&u(G,-1)},R={};switch(g){case"rtl":R.right="".concat(h*100,"%"),R.width="".concat(i*100-h*100,"%");break;case"btt":R.bottom="".concat(h*100,"%"),R.height="".concat(i*100-h*100,"%");break;case"ttb":R.top="".concat(h*100,"%"),R.height="".concat(i*100-h*100,"%");break;default:R.left="".concat(h*100,"%"),R.width="".concat(i*100-h*100,"%")}var _=y||Ie(l,Fe(Fe({},"".concat(l,"-").concat(m+1),m!==null&&p),"".concat(o,"-track-draggable"),u),d.track);return r.createElement("div",{className:_,style:Ce(Ce({},R),s),onMouseDown:C,onTouchStart:C})},Va=function(e){var o=e.prefixCls,s=e.style,c=e.values,v=e.startPoint,m=e.onStartMove,u=r.useContext(it),y=u.included,f=u.range,g=u.min,j=u.styles,S=u.classNames,b=r.useMemo(function(){if(!f){if(c.length===0)return[];var d=v??g,l=c[0];return[{start:Math.min(d,l),end:Math.max(d,l)}]}for(var h=[],i=0;i<c.length-1;i+=1)h.push({start:c[i],end:c[i+1]});return h},[c,f,v,g]);if(!y)return null;var p=b!=null&&b.length&&(S.tracks||j.tracks)?r.createElement(Qt,{index:null,prefixCls:o,start:b[0].start,end:b[b.length-1].end,replaceCls:Ie(S.tracks,"".concat(o,"-tracks")),style:j.tracks}):null;return r.createElement(r.Fragment,null,p,b.map(function(d,l){var h=d.start,i=d.end;return r.createElement(Qt,{index:l,prefixCls:o,style:Ce(Ce({},st(s,l)),j.track),start:h,end:i,key:l,onStartMove:m})}))},Xa=130;function Zt(t){var e="targetTouches"in t?t.targetTouches[0]:t;return{pageX:e.pageX,pageY:e.pageY}}function Ka(t,e,o,s,c,v,m,u,y,f,g){var j=r.useState(null),S=Oe(j,2),b=S[0],p=S[1],d=r.useState(-1),l=Oe(d,2),h=l[0],i=l[1],C=r.useState(!1),R=Oe(C,2),_=R[0],N=R[1],G=r.useState(o),Z=Oe(G,2),T=Z[0],M=Z[1],k=r.useState(o),$=Oe(k,2),Y=$[0],ee=$[1],V=r.useRef(null),X=r.useRef(null),K=r.useRef(null),Le=r.useContext(Aa),ne=Le.onDragStart,ke=Le.onDragChange;ha(function(){h===-1&&M(o)},[o,h]),r.useEffect(function(){return function(){document.removeEventListener("mousemove",V.current),document.removeEventListener("mouseup",X.current),K.current&&(K.current.removeEventListener("touchmove",V.current),K.current.removeEventListener("touchend",X.current))}},[]);var je=function(O,z,U){z!==void 0&&p(z),M(O);var le=O;U&&(le=O.filter(function(q,re){return re!==h})),m(le),ke&&ke({rawValues:O,deleteIndex:U?h:-1,draggingIndex:h,draggingValue:z})},pe=jt(function(D,O,z){if(D===-1){var U=Y[0],le=Y[Y.length-1],q=s-U,re=c-le,P=O*(c-s);P=Math.max(P,q),P=Math.min(P,re);var he=v(U+P);P=he-U;var Re=Y.map(function(ae){return ae+P});je(Re)}else{var Se=(c-s)*O,ye=Qe(T);ye[D]=Y[D];var Pe=y(ye,Se,D,"dist");je(Pe.values,Pe.value,z)}}),Ee=function(O,z,U){O.stopPropagation();var le=U||o,q=le[z];i(z),p(q),ee(le),M(le),N(!1);var re=Zt(O),P=re.pageX,he=re.pageY,Re=!1;ne&&ne({rawValues:le,draggingIndex:z,draggingValue:q});var Se=function(ae){ae.preventDefault();var fe=Zt(ae),Ue=fe.pageX,qe=fe.pageY,Ae=Ue-P,te=qe-he,I=t.current.getBoundingClientRect(),se=I.width,_e=I.height,we,ie;switch(e){case"btt":we=-te/_e,ie=Ae;break;case"ttb":we=te/_e,ie=Ae;break;case"rtl":we=-Ae/se,ie=te;break;default:we=Ae/se,ie=te}Re=f?Math.abs(ie)>Xa&&g<T.length:!1,N(Re),pe(z,we,Re)},ye=function Pe(ae){ae.preventDefault(),document.removeEventListener("mouseup",Pe),document.removeEventListener("mousemove",Se),K.current&&(K.current.removeEventListener("touchmove",V.current),K.current.removeEventListener("touchend",X.current)),V.current=null,X.current=null,K.current=null,u(Re),i(-1),N(!1)};document.addEventListener("mouseup",ye),document.addEventListener("mousemove",Se),O.currentTarget.addEventListener("touchend",ye),O.currentTarget.addEventListener("touchmove",Se),V.current=Se,X.current=ye,K.current=O.currentTarget},oe=r.useMemo(function(){var D=Qe(o).sort(function(q,re){return q-re}),O=Qe(T).sort(function(q,re){return q-re}),z={};O.forEach(function(q){z[q]=(z[q]||0)+1}),D.forEach(function(q){z[q]=(z[q]||0)-1});var U=f?1:0,le=Object.values(z).reduce(function(q,re){return q+Math.abs(re)},0);return le<=U?T:o},[o,T,f]);return[h,b,_,oe,Ee]}function Ya(t,e,o,s,c,v){var m=r.useCallback(function(b){return Math.max(t,Math.min(e,b))},[t,e]),u=r.useCallback(function(b){if(o!==null){var p=t+Math.round((m(b)-t)/o)*o,d=function(C){return(String(C).split(".")[1]||"").length},l=Math.max(d(o),d(e),d(t)),h=Number(p.toFixed(l));return t<=h&&h<=e?h:null}return null},[o,t,e,m]),y=r.useCallback(function(b){var p=m(b),d=s.map(function(i){return i.value});o!==null&&d.push(u(b)),d.push(t,e);var l=d[0],h=e-t;return d.forEach(function(i){var C=Math.abs(p-i);C<=h&&(l=i,h=C)}),l},[t,e,s,o,m,u]),f=function b(p,d,l){var h=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"unit";if(typeof d=="number"){var i,C=p[l],R=C+d,_=[];s.forEach(function(M){_.push(M.value)}),_.push(t,e),_.push(u(C));var N=d>0?1:-1;h==="unit"?_.push(u(C+N*o)):_.push(u(R)),_=_.filter(function(M){return M!==null}).filter(function(M){return d<0?M<=C:M>=C}),h==="unit"&&(_=_.filter(function(M){return M!==C}));var G=h==="unit"?C:R;i=_[0];var Z=Math.abs(i-G);if(_.forEach(function(M){var k=Math.abs(M-G);k<Z&&(i=M,Z=k)}),i===void 0)return d<0?t:e;if(h==="dist")return i;if(Math.abs(d)>1){var T=Qe(p);return T[l]=i,b(T,d-N,l,h)}return i}else{if(d==="min")return t;if(d==="max")return e}},g=function(p,d,l){var h=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"unit",i=p[l],C=f(p,d,l,h);return{value:C,changed:C!==i}},j=function(p){return v===null&&p===0||typeof v=="number"&&p<v},S=function(p,d,l){var h=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"unit",i=p.map(y),C=i[l],R=f(i,d,l,h);if(i[l]=R,c===!1){var _=v||0;l>0&&i[l-1]!==C&&(i[l]=Math.max(i[l],i[l-1]+_)),l<i.length-1&&i[l+1]!==C&&(i[l]=Math.min(i[l],i[l+1]-_))}else if(typeof v=="number"||v===null){for(var N=l+1;N<i.length;N+=1)for(var G=!0;j(i[N]-i[N-1])&&G;){var Z=g(i,1,N);i[N]=Z.value,G=Z.changed}for(var T=l;T>0;T-=1)for(var M=!0;j(i[T]-i[T-1])&&M;){var k=g(i,-1,T-1);i[T-1]=k.value,M=k.changed}for(var $=i.length-1;$>0;$-=1)for(var Y=!0;j(i[$]-i[$-1])&&Y;){var ee=g(i,-1,$-1);i[$-1]=ee.value,Y=ee.changed}for(var V=0;V<i.length-1;V+=1)for(var X=!0;j(i[V+1]-i[V])&&X;){var K=g(i,1,V+1);i[V+1]=K.value,X=K.changed}}return{value:i[l],values:i}};return[y,S]}function Ja(t){return r.useMemo(function(){if(t===!0||!t)return[!!t,!1,!1,0];var e=t.editable,o=t.draggableTrack,s=t.minCount,c=t.maxCount;return[!0,e,!e&&o,s||0,c]},[t])}var Qa=r.forwardRef(function(t,e){var o=t.prefixCls,s=o===void 0?"rc-slider":o,c=t.className,v=t.style,m=t.classNames,u=t.styles,y=t.id,f=t.disabled,g=f===void 0?!1:f,j=t.keyboard,S=j===void 0?!0:j,b=t.autoFocus,p=t.onFocus,d=t.onBlur,l=t.min,h=l===void 0?0:l,i=t.max,C=i===void 0?100:i,R=t.step,_=R===void 0?1:R,N=t.value,G=t.defaultValue,Z=t.range,T=t.count,M=t.onChange,k=t.onBeforeChange,$=t.onAfterChange,Y=t.onChangeComplete,ee=t.allowCross,V=ee===void 0?!0:ee,X=t.pushable,K=X===void 0?!1:X,Le=t.reverse,ne=t.vertical,ke=t.included,je=ke===void 0?!0:ke,pe=t.startPoint,Ee=t.trackStyle,oe=t.handleStyle,D=t.railStyle,O=t.dotStyle,z=t.activeDotStyle,U=t.marks,le=t.dots,q=t.handleRender,re=t.activeHandleRender,P=t.track,he=t.tabIndex,Re=he===void 0?0:he,Se=t.ariaLabelForHandle,ye=t.ariaLabelledByForHandle,Pe=t.ariaRequired,ae=t.ariaValueTextFormatterForHandle,fe=r.useRef(null),Ue=r.useRef(null),qe=r.useMemo(function(){return ne?Le?"ttb":"btt":Le?"rtl":"ltr"},[Le,ne]),Ae=Ja(Z),te=Oe(Ae,5),I=te[0],se=te[1],_e=te[2],we=te[3],ie=te[4],be=r.useMemo(function(){return isFinite(h)?h:0},[h]),Ne=r.useMemo(function(){return isFinite(C)?C:100},[C]),ze=r.useMemo(function(){return _!==null&&_<=0?1:_},[_]),ce=r.useMemo(function(){return typeof K=="boolean"?K?ze:!1:K>=0?K:!1},[K,ze]),ge=r.useMemo(function(){return Object.keys(U||{}).map(function(L){var x=U[L],A={value:Number(L)};return x&&fa(x)==="object"&&!r.isValidElement(x)&&("label"in x||"style"in x)?(A.style=x.style,A.label=x.label):A.label=x,A}).filter(function(L){var x=L.label;return x||typeof x=="number"}).sort(function(L,x){return L.value-x.value})},[U]),ut=Ya(be,Ne,ze,ge,V,ce),at=Oe(ut,2),We=at[0],rt=at[1],nt=ga(G,{value:N}),vt=Oe(nt,2),He=vt[0],St=vt[1],me=r.useMemo(function(){var L=He==null?[]:Array.isArray(He)?He:[He],x=Oe(L,1),A=x[0],Q=A===void 0?be:A,de=He===null?[]:[Q];if(I){if(de=Qe(L),T||He===void 0){var et=T>=0?T+1:2;for(de=de.slice(0,et);de.length<et;){var Ve;de.push((Ve=de[de.length-1])!==null&&Ve!==void 0?Ve:be)}}de.sort(function(Xe,Ke){return Xe-Ke})}return de.forEach(function(Xe,Ke){de[Ke]=We(Xe)}),de},[He,I,be,T,We]),Ze=function(x){return I?x:x[0]},n=jt(function(L){var x=Qe(L).sort(function(A,Q){return A-Q});M&&!ma(x,me,!0)&&M(Ze(x)),St(x)}),E=jt(function(L){L&&fe.current.hideHelp();var x=Ze(me);$?.(x),Wt(!$,"[rc-slider] `onAfterChange` is deprecated. Please use `onChangeComplete` instead."),Y?.(x)}),H=function(x){if(!(g||!se||me.length<=we)){var A=Qe(me);A.splice(x,1),k?.(Ze(A)),n(A);var Q=Math.max(0,x-1);fe.current.hideHelp(),fe.current.focus(Q)}},F=Ka(Ue,qe,me,be,Ne,We,n,E,rt,se,we),J=Oe(F,5),B=J[0],$e=J[1],Ge=J[2],ct=J[3],ht=J[4],Ht=function(x,A){if(!g){var Q=Qe(me),de=0,et=0,Ve=Ne-be;me.forEach(function(tt,bt){var qt=Math.abs(x-tt);qt<=Ve&&(Ve=qt,de=bt),tt<x&&(et=bt)});var Xe=de;se&&Ve!==0&&(!ie||me.length<ie)?(Q.splice(et+1,0,x),Xe=et+1):Q[de]=x,I&&!me.length&&T===void 0&&Q.push(x);var Ke=Ze(Q);if(k?.(Ke),n(Q),A){var ot,dt;(ot=document.activeElement)===null||ot===void 0||(dt=ot.blur)===null||dt===void 0||dt.call(ot),fe.current.focus(Xe),ht(A,Xe,Q)}else $?.(Ke),Wt(!$,"[rc-slider] `onAfterChange` is deprecated. Please use `onChangeComplete` instead."),Y?.(Ke)}},oa=function(x){x.preventDefault();var A=Ue.current.getBoundingClientRect(),Q=A.width,de=A.height,et=A.left,Ve=A.top,Xe=A.bottom,Ke=A.right,ot=x.clientX,dt=x.clientY,tt;switch(qe){case"btt":tt=(Xe-dt)/de;break;case"ttb":tt=(dt-Ve)/de;break;case"rtl":tt=(Ke-ot)/Q;break;default:tt=(ot-et)/Q}var bt=be+tt*(Ne-be);Ht(We(bt),x)},la=r.useState(null),Bt=Oe(la,2),kt=Bt[0],It=Bt[1],sa=function(x,A){if(!g){var Q=rt(me,x,A);k?.(Ze(me)),n(Q.values),It(Q.value)}};r.useEffect(function(){if(kt!==null){var L=me.indexOf(kt);L>=0&&fe.current.focus(L)}It(null)},[kt]);var ia=r.useMemo(function(){return _e&&ze===null?!1:_e},[_e,ze]),At=jt(function(L,x){ht(L,x),k?.(Ze(me))}),Nt=B!==-1;r.useEffect(function(){if(!Nt){var L=me.lastIndexOf($e);fe.current.focus(L)}},[Nt]);var ft=r.useMemo(function(){return Qe(ct).sort(function(L,x){return L-x})},[ct]),ca=r.useMemo(function(){return I?[ft[0],ft[ft.length-1]]:[be,ft[0]]},[ft,I,be]),zt=Oe(ca,2),Ft=zt[0],Ut=zt[1];r.useImperativeHandle(e,function(){return{focus:function(){fe.current.focus(0)},blur:function(){var x,A=document,Q=A.activeElement;(x=Ue.current)!==null&&x!==void 0&&x.contains(Q)&&Q?.blur()}}}),r.useEffect(function(){b&&fe.current.focus(0)},[]);var da=r.useMemo(function(){return{min:be,max:Ne,direction:qe,disabled:g,keyboard:S,step:ze,included:je,includedStart:Ft,includedEnd:Ut,range:I,tabIndex:Re,ariaLabelForHandle:Se,ariaLabelledByForHandle:ye,ariaRequired:Pe,ariaValueTextFormatterForHandle:ae,styles:u||{},classNames:m||{}}},[be,Ne,qe,g,S,ze,je,Ft,Ut,I,Re,Se,ye,Pe,ae,u,m]);return r.createElement(it.Provider,{value:da},r.createElement("div",{ref:Ue,className:Ie(s,c,Fe(Fe(Fe(Fe({},"".concat(s,"-disabled"),g),"".concat(s,"-vertical"),ne),"".concat(s,"-horizontal"),!ne),"".concat(s,"-with-marks"),ge.length)),style:v,onMouseDown:oa,id:y},r.createElement("div",{className:Ie("".concat(s,"-rail"),m?.rail),style:Ce(Ce({},D),u?.rail)}),P!==!1&&r.createElement(Va,{prefixCls:s,style:Ee,values:me,startPoint:pe,onStartMove:ia?At:void 0}),r.createElement(Ga,{prefixCls:s,marks:ge,dots:le,style:O,activeStyle:z}),r.createElement(Fa,{ref:fe,prefixCls:s,style:oe,values:ct,draggingIndex:B,draggingDelete:Ge,onStartMove:At,onOffsetChange:sa,onFocus:p,onBlur:d,handleRender:q,activeHandleRender:re,onChangeComplete:E,onDelete:se?H:void 0}),r.createElement(qa,{prefixCls:s,marks:ge,onClick:Ht})))});const Za=r.createContext({}),ea=r.forwardRef((t,e)=>{const{open:o,draggingDelete:s,value:c}=t,v=r.useRef(null),m=o&&!s,u=r.useRef(null);function y(){yt.cancel(u.current),u.current=null}function f(){u.current=yt(()=>{var g;(g=v.current)===null||g===void 0||g.forceAlign(),u.current=null})}return r.useEffect(()=>(m?f():y(),y),[m,t.title,c]),r.createElement(pa,Object.assign({ref:ya(v,e)},t,{open:m}))}),er=t=>{const{componentCls:e,antCls:o,controlSize:s,dotSize:c,marginFull:v,marginPart:m,colorFillContentHover:u,handleColorDisabled:y,calc:f,handleSize:g,handleSizeHover:j,handleActiveColor:S,handleActiveOutlineColor:b,handleLineWidth:p,handleLineWidthHover:d,motionDurationMid:l}=t;return{[e]:Object.assign(Object.assign({},Ca(t)),{position:"relative",height:s,margin:`${De(m)} ${De(v)}`,padding:0,cursor:"pointer",touchAction:"none","&-vertical":{margin:`${De(v)} ${De(m)}`},[`${e}-rail`]:{position:"absolute",backgroundColor:t.railBg,borderRadius:t.borderRadiusXS,transition:`background-color ${l}`},[`${e}-track,${e}-tracks`]:{position:"absolute",transition:`background-color ${l}`},[`${e}-track`]:{backgroundColor:t.trackBg,borderRadius:t.borderRadiusXS},[`${e}-track-draggable`]:{boxSizing:"content-box",backgroundClip:"content-box",border:"solid rgba(0,0,0,0)"},"&:hover":{[`${e}-rail`]:{backgroundColor:t.railHoverBg},[`${e}-track`]:{backgroundColor:t.trackHoverBg},[`${e}-dot`]:{borderColor:u},[`${e}-handle::after`]:{boxShadow:`0 0 0 ${De(p)} ${t.colorPrimaryBorderHover}`},[`${e}-dot-active`]:{borderColor:t.dotActiveBorderColor}},[`${e}-handle`]:{position:"absolute",width:g,height:g,outline:"none",userSelect:"none","&-dragging-delete":{opacity:0},"&::before":{content:'""',position:"absolute",insetInlineStart:f(p).mul(-1).equal(),insetBlockStart:f(p).mul(-1).equal(),width:f(g).add(f(p).mul(2)).equal(),height:f(g).add(f(p).mul(2)).equal(),backgroundColor:"transparent"},"&::after":{content:'""',position:"absolute",insetBlockStart:0,insetInlineStart:0,width:g,height:g,backgroundColor:t.colorBgElevated,boxShadow:`0 0 0 ${De(p)} ${t.handleColor}`,outline:"0px solid transparent",borderRadius:"50%",cursor:"pointer",transition:`
            inset-inline-start ${l},
            inset-block-start ${l},
            width ${l},
            height ${l},
            box-shadow ${l},
            outline ${l}
          `},"&:hover, &:active, &:focus":{"&::before":{insetInlineStart:f(j).sub(g).div(2).add(d).mul(-1).equal(),insetBlockStart:f(j).sub(g).div(2).add(d).mul(-1).equal(),width:f(j).add(f(d).mul(2)).equal(),height:f(j).add(f(d).mul(2)).equal()},"&::after":{boxShadow:`0 0 0 ${De(d)} ${S}`,outline:`6px solid ${b}`,width:j,height:j,insetInlineStart:t.calc(g).sub(j).div(2).equal(),insetBlockStart:t.calc(g).sub(j).div(2).equal()}}},[`&-lock ${e}-handle`]:{"&::before, &::after":{transition:"none"}},[`${e}-mark`]:{position:"absolute",fontSize:t.fontSize},[`${e}-mark-text`]:{position:"absolute",display:"inline-block",color:t.colorTextDescription,textAlign:"center",wordBreak:"keep-all",cursor:"pointer",userSelect:"none","&-active":{color:t.colorText}},[`${e}-step`]:{position:"absolute",background:"transparent",pointerEvents:"none"},[`${e}-dot`]:{position:"absolute",width:c,height:c,backgroundColor:t.colorBgElevated,border:`${De(p)} solid ${t.dotBorderColor}`,borderRadius:"50%",cursor:"pointer",transition:`border-color ${t.motionDurationSlow}`,pointerEvents:"auto","&-active":{borderColor:t.dotActiveBorderColor}},[`&${e}-disabled`]:{cursor:"not-allowed",[`${e}-rail`]:{backgroundColor:`${t.railBg} !important`},[`${e}-track`]:{backgroundColor:`${t.trackBgDisabled} !important`},[`
          ${e}-dot
        `]:{backgroundColor:t.colorBgElevated,borderColor:t.trackBgDisabled,boxShadow:"none",cursor:"not-allowed"},[`${e}-handle::after`]:{backgroundColor:t.colorBgElevated,cursor:"not-allowed",width:g,height:g,boxShadow:`0 0 0 ${De(p)} ${y}`,insetInlineStart:0,insetBlockStart:0},[`
          ${e}-mark-text,
          ${e}-dot
        `]:{cursor:"not-allowed !important"}},[`&-tooltip ${o}-tooltip-inner`]:{minWidth:"unset"}})}},na=(t,e)=>{const{componentCls:o,railSize:s,handleSize:c,dotSize:v,marginFull:m,calc:u}=t,y=e?"paddingBlock":"paddingInline",f=e?"width":"height",g=e?"height":"width",j=e?"insetBlockStart":"insetInlineStart",S=e?"top":"insetInlineStart",b=u(s).mul(3).sub(c).div(2).equal(),p=u(c).sub(s).div(2).equal(),d=e?{borderWidth:`${De(p)} 0`,transform:`translateY(${De(u(p).mul(-1).equal())})`}:{borderWidth:`0 ${De(p)}`,transform:`translateX(${De(t.calc(p).mul(-1).equal())})`};return{[y]:s,[g]:u(s).mul(3).equal(),[`${o}-rail`]:{[f]:"100%",[g]:s},[`${o}-track,${o}-tracks`]:{[g]:s},[`${o}-track-draggable`]:Object.assign({},d),[`${o}-handle`]:{[j]:b},[`${o}-mark`]:{insetInlineStart:0,top:0,[S]:u(s).mul(3).add(e?0:m).equal(),[f]:"100%"},[`${o}-step`]:{insetInlineStart:0,top:0,[S]:s,[f]:"100%",[g]:s},[`${o}-dot`]:{position:"absolute",[j]:u(s).sub(v).div(2).equal()}}},tr=t=>{const{componentCls:e,marginPartWithMark:o}=t;return{[`${e}-horizontal`]:Object.assign(Object.assign({},na(t,!0)),{[`&${e}-with-marks`]:{marginBottom:o}})}},ar=t=>{const{componentCls:e}=t;return{[`${e}-vertical`]:Object.assign(Object.assign({},na(t,!1)),{height:"100%"})}},rr=t=>{const o=t.controlHeightLG/4,s=t.controlHeightSM/2,c=t.lineWidth+1,v=t.lineWidth+1*1.5,m=t.colorPrimary,u=new Gt(m).setA(.2).toRgbString();return{controlSize:o,railSize:4,handleSize:o,handleSizeHover:s,dotSize:8,handleLineWidth:c,handleLineWidthHover:v,railBg:t.colorFillTertiary,railHoverBg:t.colorFillSecondary,trackBg:t.colorPrimaryBorder,trackHoverBg:t.colorPrimaryBorderHover,handleColor:t.colorPrimaryBorder,handleActiveColor:m,handleActiveOutlineColor:u,handleColorDisabled:new Gt(t.colorTextDisabled).onBackground(t.colorBgContainer).toHexString(),dotBorderColor:t.colorBorderSecondary,dotActiveBorderColor:t.colorPrimaryBorder,trackBgDisabled:t.colorBgContainerDisabled}},nr=ba("Slider",t=>{const e=xa(t,{marginPart:t.calc(t.controlHeight).sub(t.controlSize).div(2).equal(),marginFull:t.calc(t.controlSize).div(2).equal(),marginPartWithMark:t.calc(t.controlHeightLG).sub(t.controlSize).equal()});return[er(e),tr(e),ar(e)]},rr);function Rt(){const[t,e]=r.useState(!1),o=r.useRef(null),s=()=>{yt.cancel(o.current)},c=v=>{s(),v?e(v):o.current=yt(()=>{e(v)})};return r.useEffect(()=>s,[]),[t,c]}var or=function(t,e){var o={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.indexOf(s)<0&&(o[s]=t[s]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,s=Object.getOwnPropertySymbols(t);c<s.length;c++)e.indexOf(s[c])<0&&Object.prototype.propertyIsEnumerable.call(t,s[c])&&(o[s[c]]=t[s[c]]);return o};function lr(t,e){return t||t===null?t:e||e===null?e:o=>typeof o=="number"?o.toString():""}const sr=Ye.forwardRef((t,e)=>{const{prefixCls:o,range:s,className:c,rootClassName:v,style:m,disabled:u,tooltipPrefixCls:y,tipFormatter:f,tooltipVisible:g,getTooltipPopupContainer:j,tooltipPlacement:S,tooltip:b={},onChangeComplete:p,classNames:d,styles:l}=t,h=or(t,["prefixCls","range","className","rootClassName","style","disabled","tooltipPrefixCls","tipFormatter","tooltipVisible","getTooltipPopupContainer","tooltipPlacement","tooltip","onChangeComplete","classNames","styles"]),{vertical:i}=t,{getPrefixCls:C,direction:R,className:_,style:N,classNames:G,styles:Z,getPopupContainer:T}=ja("slider"),M=Ye.useContext(Sa),k=u??M,{handleRender:$,direction:Y}=Ye.useContext(Za),V=(Y||R)==="rtl",[X,K]=Rt(),[Le,ne]=Rt(),ke=Object.assign({},b),{open:je,placement:pe,getPopupContainer:Ee,prefixCls:oe,formatter:D}=ke,O=je??g,z=(X||Le)&&O!==!1,U=lr(D,f),[le,q]=Rt(),re=I=>{p?.(I),q(!1)},P=(I,se)=>I||(se?V?"left":"right":"top"),he=C("slider",o),[Re,Se,ye]=nr(he),Pe=Ie(c,_,G.root,d?.root,v,{[`${he}-rtl`]:V,[`${he}-lock`]:le},Se,ye);V&&!h.vertical&&(h.reverse=!h.reverse),Ye.useEffect(()=>{const I=()=>{yt(()=>{ne(!1)},1)};return document.addEventListener("mouseup",I),()=>{document.removeEventListener("mouseup",I)}},[]);const ae=s&&!O,fe=$||((I,se)=>{const{index:_e}=se,we=I.props;function ie(ce,ge,ut){var at,We,rt,nt;ut&&((We=(at=h)[ce])===null||We===void 0||We.call(at,ge)),(nt=(rt=we)[ce])===null||nt===void 0||nt.call(rt,ge)}const be=Object.assign(Object.assign({},we),{onMouseEnter:ce=>{K(!0),ie("onMouseEnter",ce)},onMouseLeave:ce=>{K(!1),ie("onMouseLeave",ce)},onMouseDown:ce=>{ne(!0),q(!0),ie("onMouseDown",ce)},onFocus:ce=>{var ge;ne(!0),(ge=h.onFocus)===null||ge===void 0||ge.call(h,ce),ie("onFocus",ce,!0)},onBlur:ce=>{var ge;ne(!1),(ge=h.onBlur)===null||ge===void 0||ge.call(h,ce),ie("onBlur",ce,!0)}}),Ne=Ye.cloneElement(I,be),ze=(!!O||z)&&U!==null;return ae?Ne:Ye.createElement(ea,Object.assign({},ke,{prefixCls:C("tooltip",oe??y),title:U?U(se.value):"",value:se.value,open:ze,placement:P(pe??S,i),key:_e,classNames:{root:`${he}-tooltip`},getPopupContainer:Ee||j||T}),Ne)}),Ue=ae?(I,se)=>{const _e=Ye.cloneElement(I,{style:Object.assign(Object.assign({},I.props.style),{visibility:"hidden"})});return Ye.createElement(ea,Object.assign({},ke,{prefixCls:C("tooltip",oe??y),title:U?U(se.value):"",open:U!==null&&z,placement:P(pe??S,i),key:"tooltip",classNames:{root:`${he}-tooltip`},getPopupContainer:Ee||j||T,draggingDelete:se.draggingDelete}),_e)}:void 0,qe=Object.assign(Object.assign(Object.assign(Object.assign({},Z.root),N),l?.root),m),Ae=Object.assign(Object.assign({},Z.tracks),l?.tracks),te=Ie(G.tracks,d?.tracks);return Re(Ye.createElement(Qa,Object.assign({},h,{classNames:Object.assign({handle:Ie(G.handle,d?.handle),rail:Ie(G.rail,d?.rail),track:Ie(G.track,d?.track)},te?{tracks:te}:{}),styles:Object.assign({handle:Object.assign(Object.assign({},Z.handle),l?.handle),rail:Object.assign(Object.assign({},Z.rail),l?.rail),track:Object.assign(Object.assign({},Z.track),l?.track)},Object.keys(Ae).length?{tracks:Ae}:{}),step:h.step,range:s,className:Pe,style:qe,disabled:k,ref:e,prefixCls:he,handleRender:fe,activeHandleRender:Ue,onChangeComplete:re})))});var ir={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M360 184h-8c4.4 0 8-3.6 8-8v8h304v-8c0 4.4 3.6 8 8 8h-8v72h72v-80c0-35.3-28.7-64-64-64H352c-35.3 0-64 28.7-64 64v80h72v-72zm504 72H160c-17.7 0-32 14.3-32 32v32c0 4.4 3.6 8 8 8h60.4l24.7 523c1.6 34.1 29.8 61 63.9 61h454c34.2 0 62.3-26.8 63.9-61l24.7-523H888c4.4 0 8-3.6 8-8v-32c0-17.7-14.3-32-32-32zM731.3 840H292.7l-24.2-512h487l-24.2 512z"}}]},name:"delete",theme:"outlined"};function Dt(){return Dt=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var o=arguments[e];for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&(t[s]=o[s])}return t},Dt.apply(this,arguments)}const cr=(t,e)=>r.createElement(ra,Dt({},t,{ref:e,icon:ir})),ta=r.forwardRef(cr);var dr={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M400 317.7h73.9V656c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V317.7H624c6.7 0 10.4-7.7 6.3-12.9L518.3 163a8 8 0 00-12.6 0l-112 141.7c-4.1 5.3-.4 13 6.3 13zM878 626h-60c-4.4 0-8 3.6-8 8v154H214V634c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v198c0 17.7 14.3 32 32 32h684c17.7 0 32-14.3 32-32V634c0-4.4-3.6-8-8-8z"}}]},name:"upload",theme:"outlined"};function Lt(){return Lt=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var o=arguments[e];for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&(t[s]=o[s])}return t},Lt.apply(this,arguments)}const ur=(t,e)=>r.createElement(ra,Lt({},t,{ref:e,icon:dr})),vr=r.forwardRef(ur),{Content:hr}=wa,{Title:Te,Text:w}=$a,{useBreakpoint:fr}=Ia,Je=t=>new Date(t).toLocaleString(),gr=720*60*1e3,mr={adminToken:"operit_submission_admin_token"},pr={account:["profile","lookup"],workbench:["progress","drafts","history"],resources:["leaderboard","templates"],system:["data"]},yr=["profile","lookup","progress","drafts"],br=["history","leaderboard","templates","data"],Mr=({language:t})=>{const e=ka[t].submissionCenter,o=t==="zh",c=!fr().md,v=Ea(),m=r.useRef(null),u=localStorage.getItem("operit_submission_admin_api_base")||"https://api.aaswordsman.org",[y,f]=r.useState(()=>Vt()),[g,j]=r.useState(()=>wt()),[S,b]=r.useState(()=>$t()),[p,d]=r.useState(()=>Mt()),[l,h]=r.useState(()=>Xt()),[i,C]=r.useState(""),[R,_]=r.useState(""),[N,G]=r.useState(""),[Z,T]=r.useState(0),[M,k]=r.useState(!1),[$,Y]=r.useState(null),[ee,V]=r.useState(null),[X,K]=r.useState(null),[Le,ne]=r.useState(!1),[ke,je]=r.useState(!1),[pe,Ee]=r.useState(!1),[oe,D]=r.useState([]),[O,z]=r.useState(null),[U,le]=r.useState(!1),[q,re]=r.useState(null),[P,he]=r.useState(null),[Re,Se]=r.useState(!1),[ye,Pe]=r.useState("account"),[ae,fe]=r.useState("profile"),Ue=!!(P&&(P.role==="admin"||P.owner)),qe=r.useMemo(()=>[{label:o?"账户":"Account",value:"account"},{label:o?"创作":"Creation",value:"workbench"},{label:o?"资源":"Resources",value:"resources"},{label:o?"系统":"System",value:"system"}],[o]),Ae=r.useMemo(()=>({account:[{label:e.profileTitle,value:"profile"},{label:e.lookupTitle,value:"lookup"}],workbench:[{label:e.progressTitle,value:"progress"},{label:e.draftTitle,value:"drafts"},{label:e.historyTitle,value:"history"}],resources:[{label:e.leaderboardTitle,value:"leaderboard"},{label:e.templateTitle,value:"templates"}],system:[{label:e.dataTitle,value:"data"}]}),[e]),te=r.useCallback(n=>!c||ae===n,[c,ae]),I=!c||yr.includes(ae),se=!c||br.includes(ae),_e=r.useMemo(()=>Object.entries(p).sort(([,n],[,E])=>(E.updated_at||"").localeCompare(n.updated_at||"")),[p]);r.useEffect(()=>{Oa(y)},[y]),r.useEffect(()=>{const n=pr[ye];n.includes(ae)||fe(n[0])},[ye,ae]);const we=r.useCallback(async()=>{try{const n=await fetch(`${u.replace(/\/+$/,"")}/api/config`);if(!n.ok)return;const E=await n.json();E?.turnstile_site_key&&G(E.turnstile_site_key)}catch{G("")}},[u]);r.useEffect(()=>{we()},[we]),r.useEffect(()=>{const n=Ot();n?.items?.length&&(D(n.items),z(n.updated_at||null))},[]),r.useEffect(()=>{const n=(localStorage.getItem(mr.adminToken)||"").trim();if(!n){he(null),Se(!1);return}let E=!1;return Se(!0),fetch(`${u.replace(/\/+$/,"")}/api/admin/auth/me`,{headers:{"X-Operit-Admin-Token":n}}).then(async H=>{if(!H.ok)throw new Error("auth_invalid");const F=await H.json().catch(()=>({}));E||he(F?.user||null)}).catch(()=>{E||he(null)}).finally(()=>{E||Se(!1)}),()=>{E=!0}},[u]);const ie=()=>{f(Vt()),j(wt()),b($t()),d(Mt()),h(Xt());const n=Ot();n?.items?.length&&(D(n.items),z(n.updated_at||null))},be=n=>{v(`/operit-submission-edit?path=${encodeURIComponent(n.target_path)}`)},Ne=n=>{La(n.target_path),j(wt())},ze=()=>{ne(!0)},ce=()=>{const n=JSON.stringify(Pa(),null,2),E=new Blob([n],{type:"application/json"}),H=URL.createObjectURL(E),F=document.createElement("a");F.href=H,F.download="operit_submission_local.json",F.click(),URL.revokeObjectURL(H)},ge=()=>{m.current?.click()},ut=async n=>{const E=n.target.files?.[0];if(E)try{const H=await E.text(),F=JSON.parse(H);Kt(F),pt.success(e.importSuccess),ie()}catch{pt.error(e.importFailed)}finally{n.target.value=""}},at=()=>{Et.confirm({title:e.clearAllTitle,content:e.clearAllHint,okText:e.confirm,cancelText:e.cancel,onOk:()=>{Ha(),ie()}})},We=()=>{if(!i.trim()||!R.trim()){pt.error(e.templateMissing);return}const n=[{id:`tmpl-${Date.now()}`,title:i.trim(),content:R.trim(),updated_at:new Date().toISOString()},...l].slice(0,50);Yt(n),h(n),C(""),_("")},rt=n=>{const E=l.filter(H=>H.id!==n.id);Yt(E),h(E)},nt=n=>n==="pending"?a.jsx(lt,{color:"gold",children:e.statusPending}):n==="approved"?a.jsx(lt,{color:"green",children:e.statusApproved}):n==="rejected"?a.jsx(lt,{color:"red",children:e.statusRejected}):n==="submitted"?a.jsx(lt,{color:"gold",children:e.statusSubmitted}):n==="edited"?a.jsx(lt,{color:"blue",children:e.statusEdited}):a.jsx(lt,{children:n}),vt=n=>n==="pending"?e.statusPending:n==="approved"?e.statusApproved:n==="rejected"?e.statusRejected:n==="submitted"?e.statusSubmitted:n==="edited"?e.statusEdited:n,He=r.useCallback(async n=>{if(U)return;const E=Ot();if(!n&&E?.updated_at){const H=new Date(E.updated_at).getTime();if(!Number.isNaN(H)&&Date.now()-H<gr){D(E.items||[]),z(E.updated_at||null);return}}le(!0),re(null);try{const H=new URL(`${u.replace(/\/+$/,"")}/api/submissions/leaderboard`);H.searchParams.set("limit","20");const F=await fetch(H.toString()),J=await F.json().catch(()=>({}));if(!F.ok)throw new Error(J?.error||e.leaderboardLoadFailed);const B=J?.items||[],$e=J?.generated_at||new Date().toISOString();Ra({updated_at:$e,items:B}),D(B),z($e)}catch(H){re(H.message||e.leaderboardLoadFailed)}finally{le(!1)}},[u,U,e.leaderboardLoadFailed]),St=n=>{if(!n)return"-";const[E,H]=n.split("@");if(!H)return`${E?.[0]||"*"}***`;const F=H.split("."),J=F[0]||"",B=F.length>1?`.${F.slice(1).join(".")}`:"",$e=E?`${E[0]}***`:"*",Ge=J?`${J[0]}***`:"*";return`${$e}@${Ge}${B}`};r.useEffect(()=>{He(!1)},[He]);const me=r.useCallback(n=>{if(!n.length)return;const E=new Map(n.map(B=>[B.id,B])),H=$t().map(B=>{const $e=E.get(B.id);return $e?{...B,status:$e.status||B.status,created_at:$e.created_at||B.created_at,reviewed_at:$e.reviewed_at||B.reviewed_at}:B});_a(H),b(H);const F=Mt();let J=!1;n.forEach(B=>{if(!B.target_path)return;const $e=B.reviewed_at||B.created_at||new Date().toISOString(),Ge=F[B.target_path],ct=B.status,ht=B.title||Ge?.title||B.target_path;(!Ge||Ge.status!==ct||Ge.updated_at!==$e||Ge.title!==ht)&&(F[B.target_path]={status:ct,updated_at:$e,title:ht},J=!0)}),J&&(Ta(F),d(F))},[]),Ze=async n=>{const E=y.authorName.trim(),H=y.authorEmail.trim();if(!E&&!H){pt.error(e.lookupRequireIdentity);return}k(!0),Y(null),V(null);try{const F=await fetch(`${u.replace(/\/+$/,"")}/api/submissions/lookup`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({author_name:E||void 0,author_email:H||void 0,turnstile_token:n})}),J=await F.json().catch(()=>({}));if(!F.ok)throw new Error(J?.error||e.lookupFailed);K({items:J?.items||[],counts:J?.counts||{total:0,pending:0,approved:0,rejected:0},last_reviewed_at:J?.last_reviewed_at||null}),je(!1),V(J?.ip_ban||null),Array.isArray(J?.items)&&me(J.items),T(B=>B+1)}catch(F){Y(F.message||e.lookupFailed)}finally{k(!1)}};return a.jsxs("main",{style:{paddingTop:88,paddingBottom:48},children:[a.jsxs(hr,{style:{maxWidth:1400,margin:"0 auto",padding:"0 24px"},children:[a.jsx(Me,{children:a.jsxs(W,{direction:"vertical",size:"middle",style:{width:"100%"},children:[a.jsxs("div",{children:[a.jsx(Te,{level:2,style:{marginBottom:8},children:e.title}),a.jsx(w,{type:"secondary",children:e.subtitle})]}),a.jsx(mt,{showIcon:!0,type:"info",message:e.localNotice}),c&&a.jsxs(W,{direction:"vertical",size:8,style:{width:"100%"},children:[a.jsx(xt,{block:!0,options:qe,value:ye,onChange:n=>Pe(n)}),a.jsx(xt,{block:!0,options:Ae[ye],value:ae,onChange:n=>fe(n)})]}),a.jsxs(W,{direction:"vertical",size:6,style:{width:"100%"},children:[a.jsxs(W,{wrap:!0,children:[a.jsx(xe,{onClick:()=>v("/operit-login?next=/operit-submission-center"),children:P?o?"切换登录":"Switch sign-in":o?"登录":"Sign in"}),Ue&&a.jsx(xe,{type:"primary",onClick:()=>v("/operit-submission-admin"),children:o?"进入审核入口":"Open review entry"})]}),Re?a.jsx(w,{type:"secondary",children:o?"正在检查登录状态…":"Checking sign-in status…"}):P?a.jsx(w,{type:"secondary",children:o?`当前已登录：${P.display_name||P.username}${P.role?`（${P.role}）`:""}`:`Signed in as: ${P.display_name||P.username}${P.role?` (${P.role})`:""}`}):null]})]})}),a.jsxs(gt,{gutter:[16,16],style:{marginTop:16},children:[a.jsx(Be,{xs:24,xl:12,style:I?void 0:{display:"none"},children:a.jsxs(W,{direction:"vertical",size:"middle",style:{width:"100%"},children:[a.jsx(Me,{style:te("profile")?void 0:{display:"none"},children:a.jsxs(W,{direction:"vertical",size:"middle",style:{width:"100%"},children:[a.jsx(Te,{level:4,style:{margin:0},children:e.profileTitle}),a.jsxs(gt,{gutter:[16,16],children:[a.jsxs(Be,{xs:24,md:12,children:[a.jsx(w,{type:"secondary",children:e.profileName}),a.jsx(Ct,{value:y.authorName,onChange:n=>f({...y,authorName:n.target.value})})]}),a.jsxs(Be,{xs:24,md:12,children:[a.jsx(w,{type:"secondary",children:e.profileEmail}),a.jsx(Ct,{value:y.authorEmail,onChange:n=>f({...y,authorEmail:n.target.value})})]})]}),a.jsxs(gt,{gutter:[16,16],children:[a.jsxs(Be,{xs:24,md:12,children:[a.jsx(w,{type:"secondary",children:e.profileEditorMode}),a.jsx("div",{children:a.jsx(xt,{value:y.editorMode,options:[{label:e.editorModeVisual,value:"visual"},{label:e.editorModeMarkdown,value:"markdown"}],onChange:n=>f({...y,editorMode:n})})})]}),a.jsxs(Be,{xs:24,md:12,children:[a.jsx(w,{type:"secondary",children:e.profileViewMode}),a.jsx("div",{children:a.jsx(xt,{value:y.viewMode,options:[{label:e.viewModeEdit,value:"edit"},{label:e.viewModeSplit,value:"split"},{label:e.viewModePreview,value:"preview"}],onChange:n=>f({...y,viewMode:n})})})]})]}),a.jsxs("div",{children:[a.jsx(w,{type:"secondary",children:e.profileFontSize}),a.jsx(sr,{min:12,max:20,value:y.fontSize,onChange:n=>f({...y,fontSize:n})})]})]})}),a.jsx(Me,{style:te("lookup")?void 0:{display:"none"},children:a.jsxs(W,{direction:"vertical",size:"middle",style:{width:"100%"},children:[a.jsx(Te,{level:4,style:{margin:0},children:e.lookupTitle}),a.jsx(w,{type:"secondary",children:e.lookupSubtitle}),a.jsx(W,{children:a.jsx(xe,{type:"primary",loading:M,onClick:()=>{if(!y.authorName.trim()&&!y.authorEmail.trim()){pt.error(e.lookupRequireIdentity);return}Ee(!0)},children:e.lookupAction})}),$&&a.jsx(mt,{type:"error",showIcon:!0,message:e.lookupFailed,description:$}),ee&&a.jsx(mt,{type:"error",showIcon:!0,message:e.ipBanTitle,description:a.jsxs(W,{direction:"vertical",size:0,children:[a.jsx(w,{children:e.ipBanSubtitle}),a.jsxs(w,{type:"secondary",children:[e.ipBanReasonLabel,": ",ee.reason||"-"]}),a.jsxs(w,{type:"secondary",children:[e.ipBanExpiresLabel,":"," ",ee.expires_at?Je(ee.expires_at):e.ipBanPermanent]}),a.jsxs(w,{type:"secondary",children:[e.ipBanByLabel,": ",ee.banned_by||"-"]})]})}),X&&a.jsxs(a.Fragment,{children:[a.jsxs(gt,{gutter:[16,16],children:[a.jsx(Be,{xs:24,md:6,children:a.jsxs(Me,{size:"small",children:[a.jsx(w,{type:"secondary",children:e.lookupTotal}),a.jsx(Te,{level:4,style:{margin:0},children:X.counts.total})]})}),a.jsx(Be,{xs:24,md:6,children:a.jsxs(Me,{size:"small",children:[a.jsx(w,{type:"secondary",children:e.lookupPending}),a.jsx(Te,{level:4,style:{margin:0},children:X.counts.pending})]})}),a.jsx(Be,{xs:24,md:6,children:a.jsxs(Me,{size:"small",children:[a.jsx(w,{type:"secondary",children:e.lookupApproved}),a.jsx(Te,{level:4,style:{margin:0},children:X.counts.approved})]})}),a.jsx(Be,{xs:24,md:6,children:a.jsxs(Me,{size:"small",children:[a.jsx(w,{type:"secondary",children:e.lookupRejected}),a.jsx(Te,{level:4,style:{margin:0},children:X.counts.rejected})]})})]}),a.jsxs(Me,{size:"small",children:[a.jsx(w,{type:"secondary",children:e.lookupLastReviewed}),a.jsx("div",{children:X.last_reviewed_at?Je(X.last_reviewed_at):e.lookupNoReviewYet})]}),a.jsx(W,{children:a.jsx(xe,{size:"small",onClick:()=>je(n=>!n),children:ke?e.lookupCollapse:e.lookupExpand})}),ke&&a.jsx(ve,{size:"small",dataSource:X.items,style:{maxHeight:320,overflow:"auto"},renderItem:n=>a.jsxs(ve.Item,{children:[a.jsx(ve.Item.Meta,{title:n.title||n.target_path,description:a.jsxs(W,{direction:"vertical",size:0,children:[a.jsx(w,{type:"secondary",children:n.target_path}),a.jsxs(w,{type:"secondary",children:[vt(n.status)," | ",Je(n.created_at)]}),n.reviewed_at&&a.jsx(w,{type:"secondary",children:e.lookupReviewedAt.replace("{time}",Je(n.reviewed_at))})]})}),a.jsx(lt,{children:n.language})]})})]})]})}),a.jsx(Me,{style:te("progress")?void 0:{display:"none"},children:a.jsxs(W,{direction:"vertical",size:"middle",style:{width:"100%"},children:[a.jsx(Te,{level:4,style:{margin:0},children:e.progressTitle}),_e.length?a.jsx(ve,{size:"small",dataSource:_e,renderItem:([n,E])=>a.jsx(ve.Item,{actions:[a.jsx(xe,{size:"small",onClick:()=>v(`/operit-submission-edit?path=${encodeURIComponent(n)}`),children:e.openEdit},"open")],children:a.jsx(ve.Item.Meta,{title:E.title||n,description:a.jsxs(W,{direction:"vertical",size:0,children:[a.jsx(w,{type:"secondary",children:n}),a.jsxs(w,{type:"secondary",children:[nt(E.status)," ",Je(E.updated_at)]})]})})})}):a.jsx(w,{type:"secondary",children:e.progressEmpty})]})}),a.jsx(Me,{style:te("drafts")?void 0:{display:"none"},children:a.jsxs(W,{direction:"vertical",size:"middle",style:{width:"100%"},children:[a.jsx(Te,{level:4,style:{margin:0},children:e.draftTitle}),g.length?a.jsx(ve,{size:"small",dataSource:g,renderItem:n=>a.jsx(ve.Item,{actions:[a.jsx(xe,{size:"small",onClick:()=>be(n),children:e.openEdit},"open"),a.jsx(xe,{size:"small",danger:!0,onClick:()=>Ne(n),children:e.deleteDraft},"delete")],children:a.jsx(ve.Item.Meta,{title:n.title||n.target_path,description:a.jsxs(W,{direction:"vertical",size:0,children:[a.jsx(w,{type:"secondary",children:n.target_path}),a.jsx(w,{type:"secondary",children:Je(n.updated_at)})]})})})}):a.jsx(w,{type:"secondary",children:e.draftEmpty})]})})]})}),a.jsx(Be,{xs:24,xl:12,style:se?void 0:{display:"none"},children:a.jsxs(W,{direction:"vertical",size:"middle",style:{width:"100%"},children:[a.jsx(Me,{style:te("history")?void 0:{display:"none"},children:a.jsxs(W,{direction:"vertical",size:"middle",style:{width:"100%"},children:[a.jsx(Te,{level:4,style:{margin:0},children:e.historyTitle}),S.length?a.jsx(ve,{size:"small",dataSource:S,renderItem:n=>a.jsx(ve.Item,{actions:[a.jsx(xe,{size:"small",onClick:()=>v(`/operit-submission-edit?path=${encodeURIComponent(n.target_path)}`),children:e.openEdit},"open")],children:a.jsx(ve.Item.Meta,{title:n.title||e.historyUntitled,description:a.jsxs(W,{direction:"vertical",size:0,children:[a.jsx(w,{type:"secondary",children:n.target_path}),a.jsxs(w,{type:"secondary",children:[vt(n.status)," | ",Je(n.created_at)]})]})})})}):a.jsx(w,{type:"secondary",children:e.historyEmpty}),a.jsx(xe,{danger:!0,onClick:ze,icon:a.jsx(ta,{}),children:e.historyClear})]})}),a.jsx(Me,{style:te("leaderboard")?void 0:{display:"none"},children:a.jsxs(W,{direction:"vertical",size:"middle",style:{width:"100%"},children:[a.jsx(Te,{level:4,style:{margin:0},children:e.leaderboardTitle}),a.jsxs(W,{wrap:!0,children:[a.jsx(xe,{size:"small",onClick:()=>He(!0),loading:U,children:e.leaderboardRefresh}),O&&a.jsx(w,{type:"secondary",children:e.leaderboardUpdatedAt.replace("{time}",Je(O))})]}),q&&a.jsx(mt,{type:"error",showIcon:!0,message:e.leaderboardLoadFailed,description:q}),oe.length?a.jsx(ve,{size:"small",dataSource:oe,renderItem:(n,E)=>a.jsx(ve.Item,{children:a.jsx(ve.Item.Meta,{title:`${E+1}. ${n.author_name||e.leaderboardAnonymous}`,description:a.jsxs(W,{direction:"vertical",size:0,children:[a.jsxs(w,{type:"secondary",children:[e.leaderboardEmailLabel,": ",St(n.author_email)]}),a.jsxs(w,{type:"secondary",children:[e.leaderboardCountLabel,": ",n.edits]})]})})})}):a.jsx(w,{type:"secondary",children:e.leaderboardEmpty})]})}),a.jsx(Me,{style:te("templates")?void 0:{display:"none"},children:a.jsxs(W,{direction:"vertical",size:"middle",style:{width:"100%"},children:[a.jsx(Te,{level:4,style:{margin:0},children:e.templateTitle}),a.jsxs(gt,{gutter:[16,16],children:[a.jsxs(Be,{xs:24,md:12,children:[a.jsx(w,{type:"secondary",children:e.templateName}),a.jsx(Ct,{value:i,onChange:n=>C(n.target.value)})]}),a.jsxs(Be,{xs:24,md:12,children:[a.jsx(w,{type:"secondary",children:e.templateContent}),a.jsx(Ct.TextArea,{rows:4,value:R,onChange:n=>_(n.target.value)})]})]}),a.jsx(xe,{type:"primary",onClick:We,children:e.templateAdd}),l.length?a.jsx(ve,{size:"small",dataSource:l,renderItem:n=>a.jsx(ve.Item,{actions:[a.jsx(xe,{size:"small",danger:!0,onClick:()=>rt(n),children:e.templateRemove},"remove")],children:a.jsx(ve.Item.Meta,{title:n.title,description:a.jsxs(W,{direction:"vertical",size:0,children:[a.jsx(w,{type:"secondary",children:Je(n.updated_at)}),a.jsx(w,{type:"secondary",style:{whiteSpace:"pre-wrap"},children:n.content})]})})})}):a.jsx(w,{type:"secondary",children:e.templateEmpty})]})}),a.jsx(Me,{style:te("data")?void 0:{display:"none"},children:a.jsxs(W,{direction:"vertical",size:"middle",style:{width:"100%"},children:[a.jsx(Te,{level:4,style:{margin:0},children:e.dataTitle}),a.jsxs(W,{wrap:!0,children:[a.jsx(xe,{icon:a.jsx(Ma,{}),onClick:ce,children:e.exportData}),a.jsx(xe,{icon:a.jsx(vr,{}),onClick:ge,children:e.importData}),a.jsx(xe,{danger:!0,icon:a.jsx(ta,{}),onClick:at,children:e.clearAll}),a.jsx(xe,{onClick:ie,children:e.refresh})]}),a.jsx("input",{ref:m,type:"file",accept:"application/json","aria-label":e.importAriaLabel,title:e.importAriaLabel,style:{display:"none"},onChange:ut})]})})]})})]})]}),a.jsx(Et,{title:e.clearHistoryTitle,open:Le,onCancel:()=>ne(!1),onOk:()=>{Kt({history:[]}),b([]),ne(!1)},okText:e.confirm,cancelText:e.cancel,children:a.jsx(w,{children:e.clearHistoryHint})}),a.jsx(Et,{title:e.lookupTurnstile,open:pe,onCancel:()=>Ee(!1),footer:null,children:a.jsx("div",{style:{marginTop:8},children:N?a.jsx(Da,{siteKey:N,onVerify:n=>{M||(Ee(!1),Ze(n))},onExpire:()=>{}},Z):a.jsx(mt,{type:"warning",message:e.turnstileMissing,showIcon:!0})})})]})};export{Mr as default};
