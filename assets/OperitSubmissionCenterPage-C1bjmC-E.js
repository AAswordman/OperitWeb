import{ak as va,r,H as oa,_ as Pt,ar as Ce,q as Ie,x as qe,as as de,z as Oe,aJ as ha,A as ga,aK as kt,av as Ze,N as fa,aw as ma,at as pa,y as Xt,al as ya,Q as ba,G as mt,k as xa,m as Ca,l as ja,n as Pe,V as Kt,f as Je,o as Sa,ab as ka,I as la,t as wa,u as Ea,j as a,b as $a,e as $e,h as G,T as Oa,B as me,d as gt,C as Ae,aL as Ma,an as Ot}from"./index-DuvJU8Kq.js";import{T as Ra}from"./TurnstileWidget-CAdzFoVI.js";import{c as Yt,l as Mt,a as Rt,i as _t,b as Jt,d as _a,j as Tt,k as Ta,h as Da,m as La,L as ue,n as Qt,f as Pa,o as Zt,p as Ha,q as Ba}from"./operitLocalStore-DjP9UoYy.js";import{s as ut}from"./index-DtBMBxfA.js";import{A as ft}from"./index-Bep-iSoQ.js";import{S as jt}from"./index-BxLuZQBC.js";import{I as St}from"./index-COkFoOHm.js";import{T as lt}from"./index-DugH8wum.js";import"./EyeOutlined-DHSIXWrc.js";function Aa(){return va()}const Ia={useBreakpoint:Aa};function Ht(t,e,o){return(t-e)/(o-e)}function It(t,e,o,s){var c=Ht(e,o,s),v={};switch(t){case"rtl":v.right="".concat(c*100,"%"),v.transform="translateX(50%)";break;case"btt":v.bottom="".concat(c*100,"%"),v.transform="translateY(50%)";break;case"ttb":v.top="".concat(c*100,"%"),v.transform="translateY(-50%)";break;default:v.left="".concat(c*100,"%"),v.transform="translateX(-50%)";break}return v}function st(t,e){return Array.isArray(t)?t[e]:t}var it=r.createContext({min:0,max:0,direction:"ltr",step:1,includedStart:0,includedEnd:0,tabIndex:0,keyboard:!0,styles:{},classNames:{}}),Na=r.createContext({}),za=["prefixCls","value","valueIndex","onStartMove","onDelete","style","render","dragging","draggingDelete","onOffsetChange","onChangeComplete","onFocus","onMouseEnter"],ea=r.forwardRef(function(t,e){var o=t.prefixCls,s=t.value,c=t.valueIndex,v=t.onStartMove,m=t.onDelete,d=t.style,y=t.render,g=t.dragging,f=t.draggingDelete,j=t.onOffsetChange,k=t.onChangeComplete,b=t.onFocus,p=t.onMouseEnter,u=oa(t,za),l=r.useContext(it),h=l.min,i=l.max,C=l.direction,R=l.disabled,_=l.keyboard,N=l.range,V=l.tabIndex,Z=l.ariaLabelForHandle,T=l.ariaLabelledByForHandle,O=l.ariaRequired,w=l.ariaValueTextFormatterForHandle,$=l.styles,J=l.classNames,ee="".concat(o,"-handle"),X=function(D){R||v(D,c)},K=function(D){b?.(D,c)},Y=function(D){p(D,c)},He=function(D){if(!R&&_){var M=null;switch(D.which||D.keyCode){case de.LEFT:M=C==="ltr"||C==="btt"?-1:1;break;case de.RIGHT:M=C==="ltr"||C==="btt"?1:-1;break;case de.UP:M=C!=="ttb"?1:-1;break;case de.DOWN:M=C!=="ttb"?-1:1;break;case de.HOME:M="min";break;case de.END:M="max";break;case de.PAGE_UP:M=2;break;case de.PAGE_DOWN:M=-2;break;case de.BACKSPACE:case de.DELETE:m?.(c);break}M!==null&&(D.preventDefault(),j(M,c))}},re=function(D){switch(D.which||D.keyCode){case de.LEFT:case de.RIGHT:case de.UP:case de.DOWN:case de.HOME:case de.END:case de.PAGE_UP:case de.PAGE_DOWN:k?.();break}},we=It(C,s,h,i),je={};if(c!==null){var pe;je={tabIndex:R?null:st(V,c),role:"slider","aria-valuemin":h,"aria-valuemax":i,"aria-valuenow":s,"aria-disabled":R,"aria-label":st(Z,c),"aria-labelledby":st(T,c),"aria-required":st(O,c),"aria-valuetext":(pe=st(w,c))===null||pe===void 0?void 0:pe(s),"aria-orientation":C==="ltr"||C==="rtl"?"horizontal":"vertical",onMouseDown:X,onTouchStart:X,onFocus:K,onMouseEnter:Y,onKeyDown:He,onKeyUp:re}}var Ee=r.createElement("div",Pt({ref:e,className:Ie(ee,qe(qe(qe({},"".concat(ee,"-").concat(c+1),c!==null&&N),"".concat(ee,"-dragging"),g),"".concat(ee,"-dragging-delete"),f),J.handle),style:Ce(Ce(Ce({},we),d),$.handle)},je,u));return y&&(Ee=y(Ee,{index:c,prefixCls:o,value:s,dragging:g,draggingDelete:f})),Ee}),Fa=["prefixCls","style","onStartMove","onOffsetChange","values","handleRender","activeHandleRender","draggingIndex","draggingDelete","onFocus"],Ua=r.forwardRef(function(t,e){var o=t.prefixCls,s=t.style,c=t.onStartMove,v=t.onOffsetChange,m=t.values,d=t.handleRender,y=t.activeHandleRender,g=t.draggingIndex,f=t.draggingDelete,j=t.onFocus,k=oa(t,Fa),b=r.useRef({}),p=r.useState(!1),u=Oe(p,2),l=u[0],h=u[1],i=r.useState(-1),C=Oe(i,2),R=C[0],_=C[1],N=function(w){_(w),h(!0)},V=function(w,$){N($),j?.(w)},Z=function(w,$){N($)};r.useImperativeHandle(e,function(){return{focus:function(w){var $;($=b.current[w])===null||$===void 0||$.focus()},hideHelp:function(){ha.flushSync(function(){h(!1)})}}});var T=Ce({prefixCls:o,onStartMove:c,onOffsetChange:v,render:d,onFocus:V,onMouseEnter:Z},k);return r.createElement(r.Fragment,null,m.map(function(O,w){var $=g===w;return r.createElement(ea,Pt({ref:function(ee){ee?b.current[w]=ee:delete b.current[w]},dragging:$,draggingDelete:$&&f,style:st(s,w),key:w,value:O,valueIndex:w},T))}),y&&l&&r.createElement(ea,Pt({key:"a11y"},T,{value:m[R],valueIndex:null,dragging:g!==-1,draggingDelete:f,render:y,style:{pointerEvents:"none"},tabIndex:null,"aria-hidden":!0})))}),qa=function(e){var o=e.prefixCls,s=e.style,c=e.children,v=e.value,m=e.onClick,d=r.useContext(it),y=d.min,g=d.max,f=d.direction,j=d.includedStart,k=d.includedEnd,b=d.included,p="".concat(o,"-text"),u=It(f,v,y,g);return r.createElement("span",{className:Ie(p,qe({},"".concat(p,"-active"),b&&j<=v&&v<=k)),style:Ce(Ce({},u),s),onMouseDown:function(h){h.stopPropagation()},onClick:function(){m(v)}},c)},Wa=function(e){var o=e.prefixCls,s=e.marks,c=e.onClick,v="".concat(o,"-mark");return s.length?r.createElement("div",{className:v},s.map(function(m){var d=m.value,y=m.style,g=m.label;return r.createElement(qa,{key:d,prefixCls:v,style:y,value:d,onClick:c},g)})):null},Ga=function(e){var o=e.prefixCls,s=e.value,c=e.style,v=e.activeStyle,m=r.useContext(it),d=m.min,y=m.max,g=m.direction,f=m.included,j=m.includedStart,k=m.includedEnd,b="".concat(o,"-dot"),p=f&&j<=s&&s<=k,u=Ce(Ce({},It(g,s,d,y)),typeof c=="function"?c(s):c);return p&&(u=Ce(Ce({},u),typeof v=="function"?v(s):v)),r.createElement("span",{className:Ie(b,qe({},"".concat(b,"-active"),p)),style:u})},Va=function(e){var o=e.prefixCls,s=e.marks,c=e.dots,v=e.style,m=e.activeStyle,d=r.useContext(it),y=d.min,g=d.max,f=d.step,j=r.useMemo(function(){var k=new Set;if(s.forEach(function(p){k.add(p.value)}),c&&f!==null)for(var b=y;b<=g;)k.add(b),b+=f;return Array.from(k)},[y,g,f,c,s]);return r.createElement("div",{className:"".concat(o,"-step")},j.map(function(k){return r.createElement(Ga,{prefixCls:o,key:k,value:k,style:v,activeStyle:m})}))},ta=function(e){var o=e.prefixCls,s=e.style,c=e.start,v=e.end,m=e.index,d=e.onStartMove,y=e.replaceCls,g=r.useContext(it),f=g.direction,j=g.min,k=g.max,b=g.disabled,p=g.range,u=g.classNames,l="".concat(o,"-track"),h=Ht(c,j,k),i=Ht(v,j,k),C=function(V){!b&&d&&d(V,-1)},R={};switch(f){case"rtl":R.right="".concat(h*100,"%"),R.width="".concat(i*100-h*100,"%");break;case"btt":R.bottom="".concat(h*100,"%"),R.height="".concat(i*100-h*100,"%");break;case"ttb":R.top="".concat(h*100,"%"),R.height="".concat(i*100-h*100,"%");break;default:R.left="".concat(h*100,"%"),R.width="".concat(i*100-h*100,"%")}var _=y||Ie(l,qe(qe({},"".concat(l,"-").concat(m+1),m!==null&&p),"".concat(o,"-track-draggable"),d),u.track);return r.createElement("div",{className:_,style:Ce(Ce({},R),s),onMouseDown:C,onTouchStart:C})},Xa=function(e){var o=e.prefixCls,s=e.style,c=e.values,v=e.startPoint,m=e.onStartMove,d=r.useContext(it),y=d.included,g=d.range,f=d.min,j=d.styles,k=d.classNames,b=r.useMemo(function(){if(!g){if(c.length===0)return[];var u=v??f,l=c[0];return[{start:Math.min(u,l),end:Math.max(u,l)}]}for(var h=[],i=0;i<c.length-1;i+=1)h.push({start:c[i],end:c[i+1]});return h},[c,g,v,f]);if(!y)return null;var p=b!=null&&b.length&&(k.tracks||j.tracks)?r.createElement(ta,{index:null,prefixCls:o,start:b[0].start,end:b[b.length-1].end,replaceCls:Ie(k.tracks,"".concat(o,"-tracks")),style:j.tracks}):null;return r.createElement(r.Fragment,null,p,b.map(function(u,l){var h=u.start,i=u.end;return r.createElement(ta,{index:l,prefixCls:o,style:Ce(Ce({},st(s,l)),j.track),start:h,end:i,key:l,onStartMove:m})}))},Ka=130;function aa(t){var e="targetTouches"in t?t.targetTouches[0]:t;return{pageX:e.pageX,pageY:e.pageY}}function Ya(t,e,o,s,c,v,m,d,y,g,f){var j=r.useState(null),k=Oe(j,2),b=k[0],p=k[1],u=r.useState(-1),l=Oe(u,2),h=l[0],i=l[1],C=r.useState(!1),R=Oe(C,2),_=R[0],N=R[1],V=r.useState(o),Z=Oe(V,2),T=Z[0],O=Z[1],w=r.useState(o),$=Oe(w,2),J=$[0],ee=$[1],X=r.useRef(null),K=r.useRef(null),Y=r.useRef(null),He=r.useContext(Na),re=He.onDragStart,we=He.onDragChange;ga(function(){h===-1&&O(o)},[o,h]),r.useEffect(function(){return function(){document.removeEventListener("mousemove",X.current),document.removeEventListener("mouseup",K.current),Y.current&&(Y.current.removeEventListener("touchmove",X.current),Y.current.removeEventListener("touchend",K.current))}},[]);var je=function(M,z,U){z!==void 0&&p(z),O(M);var oe=M;U&&(oe=M.filter(function(q,te){return te!==h})),m(oe),we&&we({rawValues:M,deleteIndex:U?h:-1,draggingIndex:h,draggingValue:z})},pe=kt(function(D,M,z){if(D===-1){var U=J[0],oe=J[J.length-1],q=s-U,te=c-oe,L=M*(c-s);L=Math.max(L,q),L=Math.min(L,te);var le=v(U+L);L=le-U;var Me=J.map(function(ve){return ve+L});je(Me)}else{var ye=(c-s)*M,Re=Ze(T);Re[D]=J[D];var _e=y(Re,ye,D,"dist");je(_e.values,_e.value,z)}}),Ee=function(M,z,U){M.stopPropagation();var oe=U||o,q=oe[z];i(z),p(q),ee(oe),O(oe),N(!1);var te=aa(M),L=te.pageX,le=te.pageY,Me=!1;re&&re({rawValues:oe,draggingIndex:z,draggingValue:q});var ye=function(ve){ve.preventDefault();var be=aa(ve),xe=be.pageX,Ne=be.pageY,ze=xe-L,Se=Ne-le,A=t.current.getBoundingClientRect(),W=A.width,Be=A.height,Te,he;switch(e){case"btt":Te=-Se/Be,he=ze;break;case"ttb":Te=Se/Be,he=ze;break;case"rtl":Te=-ze/W,he=Se;break;default:Te=ze/W,he=Se}Me=g?Math.abs(he)>Ka&&f<T.length:!1,N(Me),pe(z,Te,Me)},Re=function _e(ve){ve.preventDefault(),document.removeEventListener("mouseup",_e),document.removeEventListener("mousemove",ye),Y.current&&(Y.current.removeEventListener("touchmove",X.current),Y.current.removeEventListener("touchend",K.current)),X.current=null,K.current=null,Y.current=null,d(Me),i(-1),N(!1)};document.addEventListener("mouseup",Re),document.addEventListener("mousemove",ye),M.currentTarget.addEventListener("touchend",Re),M.currentTarget.addEventListener("touchmove",ye),X.current=ye,K.current=Re,Y.current=M.currentTarget},ne=r.useMemo(function(){var D=Ze(o).sort(function(q,te){return q-te}),M=Ze(T).sort(function(q,te){return q-te}),z={};M.forEach(function(q){z[q]=(z[q]||0)+1}),D.forEach(function(q){z[q]=(z[q]||0)-1});var U=g?1:0,oe=Object.values(z).reduce(function(q,te){return q+Math.abs(te)},0);return oe<=U?T:o},[o,T,g]);return[h,b,_,ne,Ee]}function Ja(t,e,o,s,c,v){var m=r.useCallback(function(b){return Math.max(t,Math.min(e,b))},[t,e]),d=r.useCallback(function(b){if(o!==null){var p=t+Math.round((m(b)-t)/o)*o,u=function(C){return(String(C).split(".")[1]||"").length},l=Math.max(u(o),u(e),u(t)),h=Number(p.toFixed(l));return t<=h&&h<=e?h:null}return null},[o,t,e,m]),y=r.useCallback(function(b){var p=m(b),u=s.map(function(i){return i.value});o!==null&&u.push(d(b)),u.push(t,e);var l=u[0],h=e-t;return u.forEach(function(i){var C=Math.abs(p-i);C<=h&&(l=i,h=C)}),l},[t,e,s,o,m,d]),g=function b(p,u,l){var h=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"unit";if(typeof u=="number"){var i,C=p[l],R=C+u,_=[];s.forEach(function(O){_.push(O.value)}),_.push(t,e),_.push(d(C));var N=u>0?1:-1;h==="unit"?_.push(d(C+N*o)):_.push(d(R)),_=_.filter(function(O){return O!==null}).filter(function(O){return u<0?O<=C:O>=C}),h==="unit"&&(_=_.filter(function(O){return O!==C}));var V=h==="unit"?C:R;i=_[0];var Z=Math.abs(i-V);if(_.forEach(function(O){var w=Math.abs(O-V);w<Z&&(i=O,Z=w)}),i===void 0)return u<0?t:e;if(h==="dist")return i;if(Math.abs(u)>1){var T=Ze(p);return T[l]=i,b(T,u-N,l,h)}return i}else{if(u==="min")return t;if(u==="max")return e}},f=function(p,u,l){var h=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"unit",i=p[l],C=g(p,u,l,h);return{value:C,changed:C!==i}},j=function(p){return v===null&&p===0||typeof v=="number"&&p<v},k=function(p,u,l){var h=arguments.length>3&&arguments[3]!==void 0?arguments[3]:"unit",i=p.map(y),C=i[l],R=g(i,u,l,h);if(i[l]=R,c===!1){var _=v||0;l>0&&i[l-1]!==C&&(i[l]=Math.max(i[l],i[l-1]+_)),l<i.length-1&&i[l+1]!==C&&(i[l]=Math.min(i[l],i[l+1]-_))}else if(typeof v=="number"||v===null){for(var N=l+1;N<i.length;N+=1)for(var V=!0;j(i[N]-i[N-1])&&V;){var Z=f(i,1,N);i[N]=Z.value,V=Z.changed}for(var T=l;T>0;T-=1)for(var O=!0;j(i[T]-i[T-1])&&O;){var w=f(i,-1,T-1);i[T-1]=w.value,O=w.changed}for(var $=i.length-1;$>0;$-=1)for(var J=!0;j(i[$]-i[$-1])&&J;){var ee=f(i,-1,$-1);i[$-1]=ee.value,J=ee.changed}for(var X=0;X<i.length-1;X+=1)for(var K=!0;j(i[X+1]-i[X])&&K;){var Y=f(i,1,X+1);i[X+1]=Y.value,K=Y.changed}}return{value:i[l],values:i}};return[y,k]}function Qa(t){return r.useMemo(function(){if(t===!0||!t)return[!!t,!1,!1,0];var e=t.editable,o=t.draggableTrack,s=t.minCount,c=t.maxCount;return[!0,e,!e&&o,s||0,c]},[t])}var Za=r.forwardRef(function(t,e){var o=t.prefixCls,s=o===void 0?"rc-slider":o,c=t.className,v=t.style,m=t.classNames,d=t.styles,y=t.id,g=t.disabled,f=g===void 0?!1:g,j=t.keyboard,k=j===void 0?!0:j,b=t.autoFocus,p=t.onFocus,u=t.onBlur,l=t.min,h=l===void 0?0:l,i=t.max,C=i===void 0?100:i,R=t.step,_=R===void 0?1:R,N=t.value,V=t.defaultValue,Z=t.range,T=t.count,O=t.onChange,w=t.onBeforeChange,$=t.onAfterChange,J=t.onChangeComplete,ee=t.allowCross,X=ee===void 0?!0:ee,K=t.pushable,Y=K===void 0?!1:K,He=t.reverse,re=t.vertical,we=t.included,je=we===void 0?!0:we,pe=t.startPoint,Ee=t.trackStyle,ne=t.handleStyle,D=t.railStyle,M=t.dotStyle,z=t.activeDotStyle,U=t.marks,oe=t.dots,q=t.handleRender,te=t.activeHandleRender,L=t.track,le=t.tabIndex,Me=le===void 0?0:le,ye=t.ariaLabelForHandle,Re=t.ariaLabelledByForHandle,_e=t.ariaRequired,ve=t.ariaValueTextFormatterForHandle,be=r.useRef(null),xe=r.useRef(null),Ne=r.useMemo(function(){return re?He?"ttb":"btt":He?"rtl":"ltr"},[He,re]),ze=Qa(Z),Se=Oe(ze,5),A=Se[0],W=Se[1],Be=Se[2],Te=Se[3],he=Se[4],ge=r.useMemo(function(){return isFinite(h)?h:0},[h]),De=r.useMemo(function(){return isFinite(C)?C:100},[C]),Fe=r.useMemo(function(){return _!==null&&_<=0?1:_},[_]),se=r.useMemo(function(){return typeof Y=="boolean"?Y?Fe:!1:Y>=0?Y:!1},[Y,Fe]),fe=r.useMemo(function(){return Object.keys(U||{}).map(function(B){var x=U[B],I={value:Number(B)};return x&&fa(x)==="object"&&!r.isValidElement(x)&&("label"in x||"style"in x)?(I.style=x.style,I.label=x.label):I.label=x,I}).filter(function(B){var x=B.label;return x||typeof x=="number"}).sort(function(B,x){return B.value-x.value})},[U]),vt=Ja(ge,De,Fe,fe,X,se),at=Oe(vt,2),We=at[0],rt=at[1],nt=ma(V,{value:N}),pt=Oe(nt,2),Ge=pt[0],wt=pt[1],ie=r.useMemo(function(){var B=Ge==null?[]:Array.isArray(Ge)?Ge:[Ge],x=Oe(B,1),I=x[0],Q=I===void 0?ge:I,ce=Ge===null?[]:[Q];if(A){if(ce=Ze(B),T||Ge===void 0){var et=T>=0?T+1:2;for(ce=ce.slice(0,et);ce.length<et;){var Xe;ce.push((Xe=ce[ce.length-1])!==null&&Xe!==void 0?Xe:ge)}}ce.sort(function(Ke,Ye){return Ke-Ye})}return ce.forEach(function(Ke,Ye){ce[Ye]=We(Ke)}),ce},[Ge,A,ge,T,We]),Ve=function(x){return A?x:x[0]},ct=kt(function(B){var x=Ze(B).sort(function(I,Q){return I-Q});O&&!pa(x,ie,!0)&&O(Ve(x)),wt(x)}),yt=kt(function(B){B&&be.current.hideHelp();var x=Ve(ie);$?.(x),Xt(!$,"[rc-slider] `onAfterChange` is deprecated. Please use `onChangeComplete` instead."),J?.(x)}),Et=function(x){if(!(f||!W||ie.length<=Te)){var I=Ze(ie);I.splice(x,1),w?.(Ve(I)),ct(I);var Q=Math.max(0,x-1);be.current.hideHelp(),be.current.focus(Q)}},n=Ya(xe,Ne,ie,ge,De,We,ct,yt,rt,W,Te),S=Oe(n,5),P=S[0],F=S[1],ae=S[2],H=S[3],ke=S[4],Ue=function(x,I){if(!f){var Q=Ze(ie),ce=0,et=0,Xe=De-ge;ie.forEach(function(tt,Ct){var Vt=Math.abs(x-tt);Vt<=Xe&&(Xe=Vt,ce=Ct),tt<x&&(et=Ct)});var Ke=ce;W&&Xe!==0&&(!he||ie.length<he)?(Q.splice(et+1,0,x),Ke=et+1):Q[ce]=x,A&&!ie.length&&T===void 0&&Q.push(x);var Ye=Ve(Q);if(w?.(Ye),ct(Q),I){var ot,dt;(ot=document.activeElement)===null||ot===void 0||(dt=ot.blur)===null||dt===void 0||dt.call(ot),be.current.focus(Ke),ke(I,Ke,Q)}else $?.(Ye),Xt(!$,"[rc-slider] `onAfterChange` is deprecated. Please use `onChangeComplete` instead."),J?.(Ye)}},bt=function(x){x.preventDefault();var I=xe.current.getBoundingClientRect(),Q=I.width,ce=I.height,et=I.left,Xe=I.top,Ke=I.bottom,Ye=I.right,ot=x.clientX,dt=x.clientY,tt;switch(Ne){case"btt":tt=(Ke-dt)/ce;break;case"ttb":tt=(dt-Xe)/ce;break;case"rtl":tt=(Ye-ot)/Q;break;default:tt=(ot-et)/Q}var Ct=ge+tt*(De-ge);Ue(We(Ct),x)},xt=r.useState(null),Nt=Oe(xt,2),$t=Nt[0],zt=Nt[1],ia=function(x,I){if(!f){var Q=rt(ie,x,I);w?.(Ve(ie)),ct(Q.values),zt(Q.value)}};r.useEffect(function(){if($t!==null){var B=ie.indexOf($t);B>=0&&be.current.focus(B)}zt(null)},[$t]);var ca=r.useMemo(function(){return Be&&Fe===null?!1:Be},[Be,Fe]),Ft=kt(function(B,x){ke(B,x),w?.(Ve(ie))}),Ut=P!==-1;r.useEffect(function(){if(!Ut){var B=ie.lastIndexOf(F);be.current.focus(B)}},[Ut]);var ht=r.useMemo(function(){return Ze(H).sort(function(B,x){return B-x})},[H]),da=r.useMemo(function(){return A?[ht[0],ht[ht.length-1]]:[ge,ht[0]]},[ht,A,ge]),qt=Oe(da,2),Wt=qt[0],Gt=qt[1];r.useImperativeHandle(e,function(){return{focus:function(){be.current.focus(0)},blur:function(){var x,I=document,Q=I.activeElement;(x=xe.current)!==null&&x!==void 0&&x.contains(Q)&&Q?.blur()}}}),r.useEffect(function(){b&&be.current.focus(0)},[]);var ua=r.useMemo(function(){return{min:ge,max:De,direction:Ne,disabled:f,keyboard:k,step:Fe,included:je,includedStart:Wt,includedEnd:Gt,range:A,tabIndex:Me,ariaLabelForHandle:ye,ariaLabelledByForHandle:Re,ariaRequired:_e,ariaValueTextFormatterForHandle:ve,styles:d||{},classNames:m||{}}},[ge,De,Ne,f,k,Fe,je,Wt,Gt,A,Me,ye,Re,_e,ve,d,m]);return r.createElement(it.Provider,{value:ua},r.createElement("div",{ref:xe,className:Ie(s,c,qe(qe(qe(qe({},"".concat(s,"-disabled"),f),"".concat(s,"-vertical"),re),"".concat(s,"-horizontal"),!re),"".concat(s,"-with-marks"),fe.length)),style:v,onMouseDown:bt,id:y},r.createElement("div",{className:Ie("".concat(s,"-rail"),m?.rail),style:Ce(Ce({},D),d?.rail)}),L!==!1&&r.createElement(Xa,{prefixCls:s,style:Ee,values:ie,startPoint:pe,onStartMove:ca?Ft:void 0}),r.createElement(Va,{prefixCls:s,marks:fe,dots:oe,style:M,activeStyle:z}),r.createElement(Ua,{ref:be,prefixCls:s,style:ne,values:H,draggingIndex:P,draggingDelete:ae,onStartMove:Ft,onOffsetChange:ia,onFocus:p,onBlur:u,handleRender:q,activeHandleRender:te,onChangeComplete:yt,onDelete:W?Et:void 0}),r.createElement(Wa,{prefixCls:s,marks:fe,onClick:Ue})))});const er=r.createContext({}),ra=r.forwardRef((t,e)=>{const{open:o,draggingDelete:s,value:c}=t,v=r.useRef(null),m=o&&!s,d=r.useRef(null);function y(){mt.cancel(d.current),d.current=null}function g(){d.current=mt(()=>{var f;(f=v.current)===null||f===void 0||f.forceAlign(),d.current=null})}return r.useEffect(()=>(m?g():y(),y),[m,t.title,c]),r.createElement(ya,Object.assign({ref:ba(v,e)},t,{open:m}))}),tr=t=>{const{componentCls:e,antCls:o,controlSize:s,dotSize:c,marginFull:v,marginPart:m,colorFillContentHover:d,handleColorDisabled:y,calc:g,handleSize:f,handleSizeHover:j,handleActiveColor:k,handleActiveOutlineColor:b,handleLineWidth:p,handleLineWidthHover:u,motionDurationMid:l}=t;return{[e]:Object.assign(Object.assign({},ja(t)),{position:"relative",height:s,margin:`${Pe(m)} ${Pe(v)}`,padding:0,cursor:"pointer",touchAction:"none","&-vertical":{margin:`${Pe(v)} ${Pe(m)}`},[`${e}-rail`]:{position:"absolute",backgroundColor:t.railBg,borderRadius:t.borderRadiusXS,transition:`background-color ${l}`},[`${e}-track,${e}-tracks`]:{position:"absolute",transition:`background-color ${l}`},[`${e}-track`]:{backgroundColor:t.trackBg,borderRadius:t.borderRadiusXS},[`${e}-track-draggable`]:{boxSizing:"content-box",backgroundClip:"content-box",border:"solid rgba(0,0,0,0)"},"&:hover":{[`${e}-rail`]:{backgroundColor:t.railHoverBg},[`${e}-track`]:{backgroundColor:t.trackHoverBg},[`${e}-dot`]:{borderColor:d},[`${e}-handle::after`]:{boxShadow:`0 0 0 ${Pe(p)} ${t.colorPrimaryBorderHover}`},[`${e}-dot-active`]:{borderColor:t.dotActiveBorderColor}},[`${e}-handle`]:{position:"absolute",width:f,height:f,outline:"none",userSelect:"none","&-dragging-delete":{opacity:0},"&::before":{content:'""',position:"absolute",insetInlineStart:g(p).mul(-1).equal(),insetBlockStart:g(p).mul(-1).equal(),width:g(f).add(g(p).mul(2)).equal(),height:g(f).add(g(p).mul(2)).equal(),backgroundColor:"transparent"},"&::after":{content:'""',position:"absolute",insetBlockStart:0,insetInlineStart:0,width:f,height:f,backgroundColor:t.colorBgElevated,boxShadow:`0 0 0 ${Pe(p)} ${t.handleColor}`,outline:"0px solid transparent",borderRadius:"50%",cursor:"pointer",transition:`
            inset-inline-start ${l},
            inset-block-start ${l},
            width ${l},
            height ${l},
            box-shadow ${l},
            outline ${l}
          `},"&:hover, &:active, &:focus":{"&::before":{insetInlineStart:g(j).sub(f).div(2).add(u).mul(-1).equal(),insetBlockStart:g(j).sub(f).div(2).add(u).mul(-1).equal(),width:g(j).add(g(u).mul(2)).equal(),height:g(j).add(g(u).mul(2)).equal()},"&::after":{boxShadow:`0 0 0 ${Pe(u)} ${k}`,outline:`6px solid ${b}`,width:j,height:j,insetInlineStart:t.calc(f).sub(j).div(2).equal(),insetBlockStart:t.calc(f).sub(j).div(2).equal()}}},[`&-lock ${e}-handle`]:{"&::before, &::after":{transition:"none"}},[`${e}-mark`]:{position:"absolute",fontSize:t.fontSize},[`${e}-mark-text`]:{position:"absolute",display:"inline-block",color:t.colorTextDescription,textAlign:"center",wordBreak:"keep-all",cursor:"pointer",userSelect:"none","&-active":{color:t.colorText}},[`${e}-step`]:{position:"absolute",background:"transparent",pointerEvents:"none"},[`${e}-dot`]:{position:"absolute",width:c,height:c,backgroundColor:t.colorBgElevated,border:`${Pe(p)} solid ${t.dotBorderColor}`,borderRadius:"50%",cursor:"pointer",transition:`border-color ${t.motionDurationSlow}`,pointerEvents:"auto","&-active":{borderColor:t.dotActiveBorderColor}},[`&${e}-disabled`]:{cursor:"not-allowed",[`${e}-rail`]:{backgroundColor:`${t.railBg} !important`},[`${e}-track`]:{backgroundColor:`${t.trackBgDisabled} !important`},[`
          ${e}-dot
        `]:{backgroundColor:t.colorBgElevated,borderColor:t.trackBgDisabled,boxShadow:"none",cursor:"not-allowed"},[`${e}-handle::after`]:{backgroundColor:t.colorBgElevated,cursor:"not-allowed",width:f,height:f,boxShadow:`0 0 0 ${Pe(p)} ${y}`,insetInlineStart:0,insetBlockStart:0},[`
          ${e}-mark-text,
          ${e}-dot
        `]:{cursor:"not-allowed !important"}},[`&-tooltip ${o}-tooltip-inner`]:{minWidth:"unset"}})}},sa=(t,e)=>{const{componentCls:o,railSize:s,handleSize:c,dotSize:v,marginFull:m,calc:d}=t,y=e?"paddingBlock":"paddingInline",g=e?"width":"height",f=e?"height":"width",j=e?"insetBlockStart":"insetInlineStart",k=e?"top":"insetInlineStart",b=d(s).mul(3).sub(c).div(2).equal(),p=d(c).sub(s).div(2).equal(),u=e?{borderWidth:`${Pe(p)} 0`,transform:`translateY(${Pe(d(p).mul(-1).equal())})`}:{borderWidth:`0 ${Pe(p)}`,transform:`translateX(${Pe(t.calc(p).mul(-1).equal())})`};return{[y]:s,[f]:d(s).mul(3).equal(),[`${o}-rail`]:{[g]:"100%",[f]:s},[`${o}-track,${o}-tracks`]:{[f]:s},[`${o}-track-draggable`]:Object.assign({},u),[`${o}-handle`]:{[j]:b},[`${o}-mark`]:{insetInlineStart:0,top:0,[k]:d(s).mul(3).add(e?0:m).equal(),[g]:"100%"},[`${o}-step`]:{insetInlineStart:0,top:0,[k]:s,[g]:"100%",[f]:s},[`${o}-dot`]:{position:"absolute",[j]:d(s).sub(v).div(2).equal()}}},ar=t=>{const{componentCls:e,marginPartWithMark:o}=t;return{[`${e}-horizontal`]:Object.assign(Object.assign({},sa(t,!0)),{[`&${e}-with-marks`]:{marginBottom:o}})}},rr=t=>{const{componentCls:e}=t;return{[`${e}-vertical`]:Object.assign(Object.assign({},sa(t,!1)),{height:"100%"})}},nr=t=>{const o=t.controlHeightLG/4,s=t.controlHeightSM/2,c=t.lineWidth+1,v=t.lineWidth+1*1.5,m=t.colorPrimary,d=new Kt(m).setA(.2).toRgbString();return{controlSize:o,railSize:4,handleSize:o,handleSizeHover:s,dotSize:8,handleLineWidth:c,handleLineWidthHover:v,railBg:t.colorFillTertiary,railHoverBg:t.colorFillSecondary,trackBg:t.colorPrimaryBorder,trackHoverBg:t.colorPrimaryBorderHover,handleColor:t.colorPrimaryBorder,handleActiveColor:m,handleActiveOutlineColor:d,handleColorDisabled:new Kt(t.colorTextDisabled).onBackground(t.colorBgContainer).toHexString(),dotBorderColor:t.colorBorderSecondary,dotActiveBorderColor:t.colorPrimaryBorder,trackBgDisabled:t.colorBgContainerDisabled}},or=xa("Slider",t=>{const e=Ca(t,{marginPart:t.calc(t.controlHeight).sub(t.controlSize).div(2).equal(),marginFull:t.calc(t.controlSize).div(2).equal(),marginPartWithMark:t.calc(t.controlHeightLG).sub(t.controlSize).equal()});return[tr(e),ar(e),rr(e)]},nr);function Dt(){const[t,e]=r.useState(!1),o=r.useRef(null),s=()=>{mt.cancel(o.current)},c=v=>{s(),v?e(v):o.current=mt(()=>{e(v)})};return r.useEffect(()=>s,[]),[t,c]}var lr=function(t,e){var o={};for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&e.indexOf(s)<0&&(o[s]=t[s]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,s=Object.getOwnPropertySymbols(t);c<s.length;c++)e.indexOf(s[c])<0&&Object.prototype.propertyIsEnumerable.call(t,s[c])&&(o[s[c]]=t[s[c]]);return o};function sr(t,e){return t||t===null?t:e||e===null?e:o=>typeof o=="number"?o.toString():""}const ir=Je.forwardRef((t,e)=>{const{prefixCls:o,range:s,className:c,rootClassName:v,style:m,disabled:d,tooltipPrefixCls:y,tipFormatter:g,tooltipVisible:f,getTooltipPopupContainer:j,tooltipPlacement:k,tooltip:b={},onChangeComplete:p,classNames:u,styles:l}=t,h=lr(t,["prefixCls","range","className","rootClassName","style","disabled","tooltipPrefixCls","tipFormatter","tooltipVisible","getTooltipPopupContainer","tooltipPlacement","tooltip","onChangeComplete","classNames","styles"]),{vertical:i}=t,{getPrefixCls:C,direction:R,className:_,style:N,classNames:V,styles:Z,getPopupContainer:T}=Sa("slider"),O=Je.useContext(ka),w=d??O,{handleRender:$,direction:J}=Je.useContext(er),X=(J||R)==="rtl",[K,Y]=Dt(),[He,re]=Dt(),we=Object.assign({},b),{open:je,placement:pe,getPopupContainer:Ee,prefixCls:ne,formatter:D}=we,M=je??f,z=(K||He)&&M!==!1,U=sr(D,g),[oe,q]=Dt(),te=A=>{p?.(A),q(!1)},L=(A,W)=>A||(W?X?"left":"right":"top"),le=C("slider",o),[Me,ye,Re]=or(le),_e=Ie(c,_,V.root,u?.root,v,{[`${le}-rtl`]:X,[`${le}-lock`]:oe},ye,Re);X&&!h.vertical&&(h.reverse=!h.reverse),Je.useEffect(()=>{const A=()=>{mt(()=>{re(!1)},1)};return document.addEventListener("mouseup",A),()=>{document.removeEventListener("mouseup",A)}},[]);const ve=s&&!M,be=$||((A,W)=>{const{index:Be}=W,Te=A.props;function he(se,fe,vt){var at,We,rt,nt;vt&&((We=(at=h)[se])===null||We===void 0||We.call(at,fe)),(nt=(rt=Te)[se])===null||nt===void 0||nt.call(rt,fe)}const ge=Object.assign(Object.assign({},Te),{onMouseEnter:se=>{Y(!0),he("onMouseEnter",se)},onMouseLeave:se=>{Y(!1),he("onMouseLeave",se)},onMouseDown:se=>{re(!0),q(!0),he("onMouseDown",se)},onFocus:se=>{var fe;re(!0),(fe=h.onFocus)===null||fe===void 0||fe.call(h,se),he("onFocus",se,!0)},onBlur:se=>{var fe;re(!1),(fe=h.onBlur)===null||fe===void 0||fe.call(h,se),he("onBlur",se,!0)}}),De=Je.cloneElement(A,ge),Fe=(!!M||z)&&U!==null;return ve?De:Je.createElement(ra,Object.assign({},we,{prefixCls:C("tooltip",ne??y),title:U?U(W.value):"",value:W.value,open:Fe,placement:L(pe??k,i),key:Be,classNames:{root:`${le}-tooltip`},getPopupContainer:Ee||j||T}),De)}),xe=ve?(A,W)=>{const Be=Je.cloneElement(A,{style:Object.assign(Object.assign({},A.props.style),{visibility:"hidden"})});return Je.createElement(ra,Object.assign({},we,{prefixCls:C("tooltip",ne??y),title:U?U(W.value):"",open:U!==null&&z,placement:L(pe??k,i),key:"tooltip",classNames:{root:`${le}-tooltip`},getPopupContainer:Ee||j||T,draggingDelete:W.draggingDelete}),Be)}:void 0,Ne=Object.assign(Object.assign(Object.assign(Object.assign({},Z.root),N),l?.root),m),ze=Object.assign(Object.assign({},Z.tracks),l?.tracks),Se=Ie(V.tracks,u?.tracks);return Me(Je.createElement(Za,Object.assign({},h,{classNames:Object.assign({handle:Ie(V.handle,u?.handle),rail:Ie(V.rail,u?.rail),track:Ie(V.track,u?.track)},Se?{tracks:Se}:{}),styles:Object.assign({handle:Object.assign(Object.assign({},Z.handle),l?.handle),rail:Object.assign(Object.assign({},Z.rail),l?.rail),track:Object.assign(Object.assign({},Z.track),l?.track)},Object.keys(ze).length?{tracks:ze}:{}),step:h.step,range:s,className:_e,style:Ne,disabled:w,ref:e,prefixCls:le,handleRender:be,activeHandleRender:xe,onChangeComplete:te})))});var cr={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M360 184h-8c4.4 0 8-3.6 8-8v8h304v-8c0 4.4 3.6 8 8 8h-8v72h72v-80c0-35.3-28.7-64-64-64H352c-35.3 0-64 28.7-64 64v80h72v-72zm504 72H160c-17.7 0-32 14.3-32 32v32c0 4.4 3.6 8 8 8h60.4l24.7 523c1.6 34.1 29.8 61 63.9 61h454c34.2 0 62.3-26.8 63.9-61l24.7-523H888c4.4 0 8-3.6 8-8v-32c0-17.7-14.3-32-32-32zM731.3 840H292.7l-24.2-512h487l-24.2 512z"}}]},name:"delete",theme:"outlined"};function Bt(){return Bt=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var o=arguments[e];for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&(t[s]=o[s])}return t},Bt.apply(this,arguments)}const dr=(t,e)=>r.createElement(la,Bt({},t,{ref:e,icon:cr})),na=r.forwardRef(dr);var ur={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M400 317.7h73.9V656c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V317.7H624c6.7 0 10.4-7.7 6.3-12.9L518.3 163a8 8 0 00-12.6 0l-112 141.7c-4.1 5.3-.4 13 6.3 13zM878 626h-60c-4.4 0-8 3.6-8 8v154H214V634c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v198c0 17.7 14.3 32 32 32h684c17.7 0 32-14.3 32-32V634c0-4.4-3.6-8-8-8z"}}]},name:"upload",theme:"outlined"};function At(){return At=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var o=arguments[e];for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&(t[s]=o[s])}return t},At.apply(this,arguments)}const vr=(t,e)=>r.createElement(la,At({},t,{ref:e,icon:ur})),hr=r.forwardRef(vr),{Content:gr}=$a,{Title:Le,Text:E}=Oa,{useBreakpoint:fr}=Ia,Qe=t=>new Date(t).toLocaleString(),mr=720*60*1e3,Lt={adminToken:"operit_submission_admin_token"},pr={account:["profile","lookup"],workbench:["progress","drafts","history"],resources:["leaderboard","templates"],system:["data"]},yr=["profile","lookup","progress","drafts"],br=["history","leaderboard","templates","data"],Mr=({language:t})=>{const e=wa[t].submissionCenter,o=t==="zh",c=!fr().md,v=Ea(),m=r.useRef(null),d=localStorage.getItem("operit_submission_admin_api_base")||"https://api.aaswordsman.org",[y,g]=r.useState(()=>Yt()),[f,j]=r.useState(()=>Mt()),[k,b]=r.useState(()=>Rt()),[p,u]=r.useState(()=>_t()),[l,h]=r.useState(()=>Jt()),[i,C]=r.useState(""),[R,_]=r.useState(""),[N,V]=r.useState(""),[Z,T]=r.useState(0),[O,w]=r.useState(!1),[$,J]=r.useState(null),[ee,X]=r.useState(null),[K,Y]=r.useState(null),[He,re]=r.useState(!1),[we,je]=r.useState(!1),[pe,Ee]=r.useState(!1),[ne,D]=r.useState([]),[M,z]=r.useState(null),[U,oe]=r.useState(!1),[q,te]=r.useState(null),[L,le]=r.useState(null),[Me,ye]=r.useState(!1),[Re,_e]=r.useState(!1),[ve,be]=r.useState("account"),[xe,Ne]=r.useState("profile"),ze=!!(L&&(L.role==="admin"||L.owner)),Se=r.useMemo(()=>[{label:o?"账户":"Account",value:"account"},{label:o?"创作":"Creation",value:"workbench"},{label:o?"资源":"Resources",value:"resources"},{label:o?"系统":"System",value:"system"}],[o]),A=r.useMemo(()=>({account:[{label:e.profileTitle,value:"profile"},{label:e.lookupTitle,value:"lookup"}],workbench:[{label:e.progressTitle,value:"progress"},{label:e.draftTitle,value:"drafts"},{label:e.historyTitle,value:"history"}],resources:[{label:e.leaderboardTitle,value:"leaderboard"},{label:e.templateTitle,value:"templates"}],system:[{label:e.dataTitle,value:"data"}]}),[e]),W=r.useCallback(n=>!c||xe===n,[c,xe]),Be=!c||yr.includes(xe),Te=!c||br.includes(xe),he=r.useMemo(()=>Object.entries(p).sort(([,n],[,S])=>(S.updated_at||"").localeCompare(n.updated_at||"")),[p]);r.useEffect(()=>{_a(y)},[y]),r.useEffect(()=>{const n=pr[ve];n.includes(xe)||Ne(n[0])},[ve,xe]);const ge=r.useCallback(async()=>{try{const n=await fetch(`${d.replace(/\/+$/,"")}/api/config`);if(!n.ok)return;const S=await n.json();S?.turnstile_site_key&&V(S.turnstile_site_key)}catch{V("")}},[d]);r.useEffect(()=>{ge()},[ge]),r.useEffect(()=>{const n=Tt();n?.items?.length&&(D(n.items),z(n.updated_at||null))},[]),r.useEffect(()=>{const n=(localStorage.getItem(Lt.adminToken)||"").trim();if(!n){le(null),ye(!1);return}let S=!1;return ye(!0),fetch(`${d.replace(/\/+$/,"")}/api/admin/auth/me`,{headers:{"X-Operit-Admin-Token":n}}).then(async P=>{if(!P.ok)throw new Error("auth_invalid");const F=await P.json().catch(()=>({}));S||le(F?.user||null)}).catch(()=>{S||le(null)}).finally(()=>{S||ye(!1)}),()=>{S=!0}},[d]);const De=()=>{g(Yt()),j(Mt()),b(Rt()),u(_t()),h(Jt());const n=Tt();n?.items?.length&&(D(n.items),z(n.updated_at||null))},Fe=r.useCallback(async()=>{const n=(localStorage.getItem(Lt.adminToken)||"").trim();_e(!0);try{n&&await fetch(`${d.replace(/\/+$/,"")}/api/admin/auth/logout`,{method:"POST",headers:{"X-Operit-Admin-Token":n}})}catch{}finally{localStorage.removeItem(Lt.adminToken),le(null),ye(!1),_e(!1),ut.success(o?"退出登录成功":"Signed out successfully")}},[d,o]),se=n=>{v(`/operit-submission-edit?path=${encodeURIComponent(n.target_path)}`)},fe=n=>{Pa(n.target_path),j(Mt())},vt=()=>{re(!0)},at=()=>{const n=JSON.stringify(Ha(),null,2),S=new Blob([n],{type:"application/json"}),P=URL.createObjectURL(S),F=document.createElement("a");F.href=P,F.download="operit_submission_local.json",F.click(),URL.revokeObjectURL(P)},We=()=>{m.current?.click()},rt=async n=>{const S=n.target.files?.[0];if(S)try{const P=await S.text(),F=JSON.parse(P);Qt(F),ut.success(e.importSuccess),De()}catch{ut.error(e.importFailed)}finally{n.target.value=""}},nt=()=>{Ot.confirm({title:e.clearAllTitle,content:e.clearAllHint,okText:e.confirm,cancelText:e.cancel,onOk:()=>{Ba(),De()}})},pt=()=>{if(!i.trim()||!R.trim()){ut.error(e.templateMissing);return}const n=[{id:`tmpl-${Date.now()}`,title:i.trim(),content:R.trim(),updated_at:new Date().toISOString()},...l].slice(0,50);Zt(n),h(n),C(""),_("")},Ge=n=>{const S=l.filter(P=>P.id!==n.id);Zt(S),h(S)},wt=n=>n==="pending"?a.jsx(lt,{color:"gold",children:e.statusPending}):n==="approved"?a.jsx(lt,{color:"green",children:e.statusApproved}):n==="rejected"?a.jsx(lt,{color:"red",children:e.statusRejected}):n==="submitted"?a.jsx(lt,{color:"gold",children:e.statusSubmitted}):n==="edited"?a.jsx(lt,{color:"blue",children:e.statusEdited}):a.jsx(lt,{children:n}),ie=n=>n==="pending"?e.statusPending:n==="approved"?e.statusApproved:n==="rejected"?e.statusRejected:n==="submitted"?e.statusSubmitted:n==="edited"?e.statusEdited:n,Ve=r.useCallback(async n=>{if(U)return;const S=Tt();if(!n&&S?.updated_at){const P=new Date(S.updated_at).getTime();if(!Number.isNaN(P)&&Date.now()-P<mr){D(S.items||[]),z(S.updated_at||null);return}}oe(!0),te(null);try{const P=new URL(`${d.replace(/\/+$/,"")}/api/submissions/leaderboard`);P.searchParams.set("limit","20");const F=await fetch(P.toString()),ae=await F.json().catch(()=>({}));if(!F.ok)throw new Error(ae?.error||e.leaderboardLoadFailed);const H=ae?.items||[],ke=ae?.generated_at||new Date().toISOString();Ta({updated_at:ke,items:H}),D(H),z(ke)}catch(P){te(P.message||e.leaderboardLoadFailed)}finally{oe(!1)}},[d,U,e.leaderboardLoadFailed]),ct=n=>{if(!n)return"-";const[S,P]=n.split("@");if(!P)return`${S?.[0]||"*"}***`;const F=P.split("."),ae=F[0]||"",H=F.length>1?`.${F.slice(1).join(".")}`:"",ke=S?`${S[0]}***`:"*",Ue=ae?`${ae[0]}***`:"*";return`${ke}@${Ue}${H}`};r.useEffect(()=>{Ve(!1)},[Ve]);const yt=r.useCallback(n=>{if(!n.length)return;const S=new Map(n.map(H=>[H.id,H])),P=Rt().map(H=>{const ke=S.get(H.id);return ke?{...H,status:ke.status||H.status,created_at:ke.created_at||H.created_at,reviewed_at:ke.reviewed_at||H.reviewed_at}:H});Da(P),b(P);const F=_t();let ae=!1;n.forEach(H=>{if(!H.target_path)return;const ke=H.reviewed_at||H.created_at||new Date().toISOString(),Ue=F[H.target_path],bt=H.status,xt=H.title||Ue?.title||H.target_path;(!Ue||Ue.status!==bt||Ue.updated_at!==ke||Ue.title!==xt)&&(F[H.target_path]={status:bt,updated_at:ke,title:xt},ae=!0)}),ae&&(La(F),u(F))},[]),Et=async n=>{const S=y.authorName.trim(),P=y.authorEmail.trim();if(!S&&!P){ut.error(e.lookupRequireIdentity);return}w(!0),J(null),X(null);try{const F=await fetch(`${d.replace(/\/+$/,"")}/api/submissions/lookup`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({author_name:S||void 0,author_email:P||void 0,turnstile_token:n})}),ae=await F.json().catch(()=>({}));if(!F.ok)throw new Error(ae?.error||e.lookupFailed);Y({items:ae?.items||[],counts:ae?.counts||{total:0,pending:0,approved:0,rejected:0},last_reviewed_at:ae?.last_reviewed_at||null}),je(!1),X(ae?.ip_ban||null),Array.isArray(ae?.items)&&yt(ae.items),T(H=>H+1)}catch(F){J(F.message||e.lookupFailed)}finally{w(!1)}};return a.jsxs("main",{style:{paddingTop:88,paddingBottom:48},children:[a.jsxs(gr,{style:{maxWidth:1400,margin:"0 auto",padding:"0 24px"},children:[a.jsx($e,{children:a.jsxs(G,{direction:"vertical",size:"middle",style:{width:"100%"},children:[a.jsxs("div",{children:[a.jsx(Le,{level:2,style:{marginBottom:8},children:e.title}),a.jsx(E,{type:"secondary",children:e.subtitle})]}),a.jsx(ft,{showIcon:!0,type:"info",message:e.localNotice}),c&&a.jsxs(G,{direction:"vertical",size:8,style:{width:"100%"},children:[a.jsx(jt,{block:!0,options:Se,value:ve,onChange:n=>be(n)}),a.jsx(jt,{block:!0,options:A[ve],value:xe,onChange:n=>Ne(n)})]}),a.jsxs(G,{direction:"vertical",size:6,style:{width:"100%"},children:[a.jsxs(G,{wrap:!0,children:[a.jsx(me,{onClick:()=>v("/operit-login?next=/operit-submission-center"),children:L?o?"切换登录":"Switch sign-in":o?"登录":"Sign in"}),L&&a.jsx(me,{danger:!0,onClick:Fe,loading:Re,children:o?"退出登录":"Sign out"}),ze&&a.jsx(me,{type:"primary",onClick:()=>v("/operit-submission-admin"),children:o?"进入审核入口":"Open review entry"})]}),Me?a.jsx(E,{type:"secondary",children:o?"正在检查登录状态…":"Checking sign-in status…"}):L?a.jsx(E,{type:"secondary",children:o?`当前已登录：${L.display_name||L.username}${L.role?`（${L.role}）`:""}`:`Signed in as: ${L.display_name||L.username}${L.role?` (${L.role})`:""}`}):null]})]})}),a.jsxs(gt,{gutter:[16,16],style:{marginTop:16},children:[a.jsx(Ae,{xs:24,xl:12,style:Be?void 0:{display:"none"},children:a.jsxs(G,{direction:"vertical",size:"middle",style:{width:"100%"},children:[a.jsx($e,{style:W("profile")?void 0:{display:"none"},children:a.jsxs(G,{direction:"vertical",size:"middle",style:{width:"100%"},children:[a.jsx(Le,{level:4,style:{margin:0},children:e.profileTitle}),a.jsxs(gt,{gutter:[16,16],children:[a.jsxs(Ae,{xs:24,md:12,children:[a.jsx(E,{type:"secondary",children:e.profileName}),a.jsx(St,{value:y.authorName,onChange:n=>g({...y,authorName:n.target.value})})]}),a.jsxs(Ae,{xs:24,md:12,children:[a.jsx(E,{type:"secondary",children:e.profileEmail}),a.jsx(St,{value:y.authorEmail,onChange:n=>g({...y,authorEmail:n.target.value})})]})]}),a.jsxs(gt,{gutter:[16,16],children:[a.jsxs(Ae,{xs:24,md:12,children:[a.jsx(E,{type:"secondary",children:e.profileEditorMode}),a.jsx("div",{children:a.jsx(jt,{value:y.editorMode,options:[{label:e.editorModeVisual,value:"visual"},{label:e.editorModeMarkdown,value:"markdown"}],onChange:n=>g({...y,editorMode:n})})})]}),a.jsxs(Ae,{xs:24,md:12,children:[a.jsx(E,{type:"secondary",children:e.profileViewMode}),a.jsx("div",{children:a.jsx(jt,{value:y.viewMode,options:[{label:e.viewModeEdit,value:"edit"},{label:e.viewModeSplit,value:"split"},{label:e.viewModePreview,value:"preview"}],onChange:n=>g({...y,viewMode:n})})})]})]}),a.jsxs("div",{children:[a.jsx(E,{type:"secondary",children:e.profileFontSize}),a.jsx(ir,{min:12,max:20,value:y.fontSize,onChange:n=>g({...y,fontSize:n})})]})]})}),a.jsx($e,{style:W("lookup")?void 0:{display:"none"},children:a.jsxs(G,{direction:"vertical",size:"middle",style:{width:"100%"},children:[a.jsx(Le,{level:4,style:{margin:0},children:e.lookupTitle}),a.jsx(E,{type:"secondary",children:e.lookupSubtitle}),a.jsx(G,{children:a.jsx(me,{type:"primary",loading:O,onClick:()=>{if(!y.authorName.trim()&&!y.authorEmail.trim()){ut.error(e.lookupRequireIdentity);return}Ee(!0)},children:e.lookupAction})}),$&&a.jsx(ft,{type:"error",showIcon:!0,message:e.lookupFailed,description:$}),ee&&a.jsx(ft,{type:"error",showIcon:!0,message:e.ipBanTitle,description:a.jsxs(G,{direction:"vertical",size:0,children:[a.jsx(E,{children:e.ipBanSubtitle}),a.jsxs(E,{type:"secondary",children:[e.ipBanReasonLabel,": ",ee.reason||"-"]}),a.jsxs(E,{type:"secondary",children:[e.ipBanExpiresLabel,":"," ",ee.expires_at?Qe(ee.expires_at):e.ipBanPermanent]}),a.jsxs(E,{type:"secondary",children:[e.ipBanByLabel,": ",ee.banned_by||"-"]})]})}),K&&a.jsxs(a.Fragment,{children:[a.jsxs(gt,{gutter:[16,16],children:[a.jsx(Ae,{xs:24,md:6,children:a.jsxs($e,{size:"small",children:[a.jsx(E,{type:"secondary",children:e.lookupTotal}),a.jsx(Le,{level:4,style:{margin:0},children:K.counts.total})]})}),a.jsx(Ae,{xs:24,md:6,children:a.jsxs($e,{size:"small",children:[a.jsx(E,{type:"secondary",children:e.lookupPending}),a.jsx(Le,{level:4,style:{margin:0},children:K.counts.pending})]})}),a.jsx(Ae,{xs:24,md:6,children:a.jsxs($e,{size:"small",children:[a.jsx(E,{type:"secondary",children:e.lookupApproved}),a.jsx(Le,{level:4,style:{margin:0},children:K.counts.approved})]})}),a.jsx(Ae,{xs:24,md:6,children:a.jsxs($e,{size:"small",children:[a.jsx(E,{type:"secondary",children:e.lookupRejected}),a.jsx(Le,{level:4,style:{margin:0},children:K.counts.rejected})]})})]}),a.jsxs($e,{size:"small",children:[a.jsx(E,{type:"secondary",children:e.lookupLastReviewed}),a.jsx("div",{children:K.last_reviewed_at?Qe(K.last_reviewed_at):e.lookupNoReviewYet})]}),a.jsx(G,{children:a.jsx(me,{size:"small",onClick:()=>je(n=>!n),children:we?e.lookupCollapse:e.lookupExpand})}),we&&a.jsx(ue,{size:"small",dataSource:K.items,style:{maxHeight:320,overflow:"auto"},renderItem:n=>a.jsxs(ue.Item,{children:[a.jsx(ue.Item.Meta,{title:n.title||n.target_path,description:a.jsxs(G,{direction:"vertical",size:0,children:[a.jsx(E,{type:"secondary",children:n.target_path}),a.jsxs(E,{type:"secondary",children:[ie(n.status)," | ",Qe(n.created_at)]}),n.reviewed_at&&a.jsx(E,{type:"secondary",children:e.lookupReviewedAt.replace("{time}",Qe(n.reviewed_at))})]})}),a.jsx(lt,{children:n.language})]})})]})]})}),a.jsx($e,{style:W("progress")?void 0:{display:"none"},children:a.jsxs(G,{direction:"vertical",size:"middle",style:{width:"100%"},children:[a.jsx(Le,{level:4,style:{margin:0},children:e.progressTitle}),he.length?a.jsx(ue,{size:"small",dataSource:he,renderItem:([n,S])=>a.jsx(ue.Item,{actions:[a.jsx(me,{size:"small",onClick:()=>v(`/operit-submission-edit?path=${encodeURIComponent(n)}`),children:e.openEdit},"open")],children:a.jsx(ue.Item.Meta,{title:S.title||n,description:a.jsxs(G,{direction:"vertical",size:0,children:[a.jsx(E,{type:"secondary",children:n}),a.jsxs(E,{type:"secondary",children:[wt(S.status)," ",Qe(S.updated_at)]})]})})})}):a.jsx(E,{type:"secondary",children:e.progressEmpty})]})}),a.jsx($e,{style:W("drafts")?void 0:{display:"none"},children:a.jsxs(G,{direction:"vertical",size:"middle",style:{width:"100%"},children:[a.jsx(Le,{level:4,style:{margin:0},children:e.draftTitle}),f.length?a.jsx(ue,{size:"small",dataSource:f,renderItem:n=>a.jsx(ue.Item,{actions:[a.jsx(me,{size:"small",onClick:()=>se(n),children:e.openEdit},"open"),a.jsx(me,{size:"small",danger:!0,onClick:()=>fe(n),children:e.deleteDraft},"delete")],children:a.jsx(ue.Item.Meta,{title:n.title||n.target_path,description:a.jsxs(G,{direction:"vertical",size:0,children:[a.jsx(E,{type:"secondary",children:n.target_path}),a.jsx(E,{type:"secondary",children:Qe(n.updated_at)})]})})})}):a.jsx(E,{type:"secondary",children:e.draftEmpty})]})})]})}),a.jsx(Ae,{xs:24,xl:12,style:Te?void 0:{display:"none"},children:a.jsxs(G,{direction:"vertical",size:"middle",style:{width:"100%"},children:[a.jsx($e,{style:W("history")?void 0:{display:"none"},children:a.jsxs(G,{direction:"vertical",size:"middle",style:{width:"100%"},children:[a.jsx(Le,{level:4,style:{margin:0},children:e.historyTitle}),k.length?a.jsx(ue,{size:"small",dataSource:k,renderItem:n=>a.jsx(ue.Item,{actions:[a.jsx(me,{size:"small",onClick:()=>v(`/operit-submission-edit?path=${encodeURIComponent(n.target_path)}`),children:e.openEdit},"open")],children:a.jsx(ue.Item.Meta,{title:n.title||e.historyUntitled,description:a.jsxs(G,{direction:"vertical",size:0,children:[a.jsx(E,{type:"secondary",children:n.target_path}),a.jsxs(E,{type:"secondary",children:[ie(n.status)," | ",Qe(n.created_at)]})]})})})}):a.jsx(E,{type:"secondary",children:e.historyEmpty}),a.jsx(me,{danger:!0,onClick:vt,icon:a.jsx(na,{}),children:e.historyClear})]})}),a.jsx($e,{style:W("leaderboard")?void 0:{display:"none"},children:a.jsxs(G,{direction:"vertical",size:"middle",style:{width:"100%"},children:[a.jsx(Le,{level:4,style:{margin:0},children:e.leaderboardTitle}),a.jsxs(G,{wrap:!0,children:[a.jsx(me,{size:"small",onClick:()=>Ve(!0),loading:U,children:e.leaderboardRefresh}),M&&a.jsx(E,{type:"secondary",children:e.leaderboardUpdatedAt.replace("{time}",Qe(M))})]}),q&&a.jsx(ft,{type:"error",showIcon:!0,message:e.leaderboardLoadFailed,description:q}),ne.length?a.jsx(ue,{size:"small",dataSource:ne,renderItem:(n,S)=>a.jsx(ue.Item,{children:a.jsx(ue.Item.Meta,{title:`${S+1}. ${n.author_name||e.leaderboardAnonymous}`,description:a.jsxs(G,{direction:"vertical",size:0,children:[a.jsxs(E,{type:"secondary",children:[e.leaderboardEmailLabel,": ",ct(n.author_email)]}),a.jsxs(E,{type:"secondary",children:[e.leaderboardCountLabel,": ",n.changed_words]})]})})})}):a.jsx(E,{type:"secondary",children:e.leaderboardEmpty})]})}),a.jsx($e,{style:W("templates")?void 0:{display:"none"},children:a.jsxs(G,{direction:"vertical",size:"middle",style:{width:"100%"},children:[a.jsx(Le,{level:4,style:{margin:0},children:e.templateTitle}),a.jsxs(gt,{gutter:[16,16],children:[a.jsxs(Ae,{xs:24,md:12,children:[a.jsx(E,{type:"secondary",children:e.templateName}),a.jsx(St,{value:i,onChange:n=>C(n.target.value)})]}),a.jsxs(Ae,{xs:24,md:12,children:[a.jsx(E,{type:"secondary",children:e.templateContent}),a.jsx(St.TextArea,{rows:4,value:R,onChange:n=>_(n.target.value)})]})]}),a.jsx(me,{type:"primary",onClick:pt,children:e.templateAdd}),l.length?a.jsx(ue,{size:"small",dataSource:l,renderItem:n=>a.jsx(ue.Item,{actions:[a.jsx(me,{size:"small",danger:!0,onClick:()=>Ge(n),children:e.templateRemove},"remove")],children:a.jsx(ue.Item.Meta,{title:n.title,description:a.jsxs(G,{direction:"vertical",size:0,children:[a.jsx(E,{type:"secondary",children:Qe(n.updated_at)}),a.jsx(E,{type:"secondary",style:{whiteSpace:"pre-wrap"},children:n.content})]})})})}):a.jsx(E,{type:"secondary",children:e.templateEmpty})]})}),a.jsx($e,{style:W("data")?void 0:{display:"none"},children:a.jsxs(G,{direction:"vertical",size:"middle",style:{width:"100%"},children:[a.jsx(Le,{level:4,style:{margin:0},children:e.dataTitle}),a.jsxs(G,{wrap:!0,children:[a.jsx(me,{icon:a.jsx(Ma,{}),onClick:at,children:e.exportData}),a.jsx(me,{icon:a.jsx(hr,{}),onClick:We,children:e.importData}),a.jsx(me,{danger:!0,icon:a.jsx(na,{}),onClick:nt,children:e.clearAll}),a.jsx(me,{onClick:De,children:e.refresh})]}),a.jsx("input",{ref:m,type:"file",accept:"application/json","aria-label":e.importAriaLabel,title:e.importAriaLabel,style:{display:"none"},onChange:rt})]})})]})})]})]}),a.jsx(Ot,{title:e.clearHistoryTitle,open:He,onCancel:()=>re(!1),onOk:()=>{Qt({history:[]}),b([]),re(!1)},okText:e.confirm,cancelText:e.cancel,children:a.jsx(E,{children:e.clearHistoryHint})}),a.jsx(Ot,{title:e.lookupTurnstile,open:pe,onCancel:()=>Ee(!1),footer:null,children:a.jsx("div",{style:{marginTop:8},children:N?a.jsx(Ra,{siteKey:N,onVerify:n=>{O||(Ee(!1),Et(n))},onExpire:()=>{}},Z):a.jsx(ft,{type:"warning",message:e.turnstileMissing,showIcon:!0})})})]})};export{Mr as default};
