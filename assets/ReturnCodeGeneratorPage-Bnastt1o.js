import{r as d,I as R,i as A,j as e,e as D,h as B,T as G,B as p}from"./index-B-zrKzi5.js";import{I as l}from"./index-CN0xdKxZ.js";import{R as E}from"./ReloadOutlined-C1_ugCtW.js";import{s as u}from"./index-ByUAJE7D.js";import"./EyeOutlined-CtQHaQlo.js";function m(){return m=Object.assign?Object.assign.bind():function(a){for(var o=1;o<arguments.length;o++){var i=arguments[o];for(var c in i)Object.prototype.hasOwnProperty.call(i,c)&&(a[c]=i[c])}return a},m.apply(this,arguments)}const $=(a,o)=>d.createElement(R,m({},a,{ref:o,icon:A})),H=d.forwardRef($),{Paragraph:g,Text:y}=G,M=()=>{const[a,o]=d.useState(""),[i,c]=d.useState(""),[h,f]=d.useState(""),x=()=>{const s=new Uint8Array(8);return window.crypto.getRandomValues(s),Array.from(s,t=>("0"+t.toString(16)).slice(-2)).join("")};d.useEffect(()=>{c(x())},[]);const j=s=>{const t=s.target.value;o(t);const n=/\[OperitAI邀请码:([^\]]+)\]/,r=t.match(n);r&&r[1]&&setTimeout(()=>{o(r[1])},10)},C=async(s,t)=>{const n=new TextEncoder,r=n.encode(s),T=n.encode(t),S=await window.crypto.subtle.importKey("raw",T,{name:"HMAC",hash:"SHA-256"},!1,["sign"]),O=await window.crypto.subtle.sign("HMAC",S,r);return w(O)},w=s=>{const t=new Uint8Array(s);let n="";for(let r=0;r<t.byteLength;r++)n+=String.fromCharCode(t[r]);return btoa(n)},v=async(s,t)=>{const n=await C(t,s);return`${t}:${n}`},I=async()=>{const t=a.trim().split(":")[0],n=i.trim();if(!t||!n){u.error("请输入有效的分享语或邀请码");return}try{const r=await v(t,n);f(r),u.success("返回码生成成功！")}catch(r){u.error("生成返回码失败: "+r.message)}},b=async()=>{if(h)try{await navigator.clipboard.writeText(h),u.success("复制成功！")}catch{u.error("复制失败，请手动复制")}};return e.jsx(D,{title:"邀请返回码生成工具",style:{width:"100%"},children:e.jsxs(B,{direction:"vertical",size:"middle",style:{width:"100%"},children:[e.jsx("div",{children:e.jsx(g,{children:"通过此工具，您可以为被邀请用户生成有效的返回码。只需输入您的邀请码和对方的设备ID，点击生成按钮即可。"})}),e.jsxs("div",{children:[e.jsx(y,{strong:!0,children:"分享语或邀请码:"}),e.jsx(l,{placeholder:"请粘贴分享语，将自动提取邀请信息",value:a,onChange:j,style:{marginTop:8}})]}),e.jsxs("div",{children:[e.jsx(y,{strong:!0,children:"设备ID (已随机生成):"}),e.jsxs(l.Group,{compact:!0,style:{marginTop:8},children:[e.jsx(l,{value:i,readOnly:!0,style:{width:"calc(100% - 40px)"}}),e.jsx(p,{icon:e.jsx(E,{}),onClick:()=>c(x()),title:"重新生成随机设备ID"})]})]}),e.jsx(p,{type:"primary",onClick:I,style:{width:"100%"},children:"生成返回码"}),h&&e.jsxs("div",{children:[e.jsx(y,{strong:!0,children:"返回码："}),e.jsxs(l.Group,{compact:!0,style:{marginTop:8},children:[e.jsx(l,{value:h,readOnly:!0,style:{width:"calc(100% - 40px)"}}),e.jsx(p,{icon:e.jsx(H,{}),onClick:b,title:"复制到剪贴板"})]}),e.jsx(g,{type:"secondary",style:{marginTop:8,fontSize:12},children:"返回码格式：设备ID:签名"})]})]})})},L=()=>e.jsx("div",{style:{padding:"24px",height:"100%",width:"100%"},children:e.jsx(M,{})});export{L as default};
